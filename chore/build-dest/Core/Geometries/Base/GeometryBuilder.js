import Vector3 from "../../../Math/Vector3";
class GeometryBuilder {
    static addDividedQuad(pos, normal, uv, index, divX, divY) {
        const startIndex = pos.length / 3;
        const xP = 2.0 / divX;
        const yP = 2.0 / divY;
        for (let i = 0; i < divX + 1; i++) {
            const x = xP * i - 1;
            for (let j = 0; j < divY + 1; j++) {
                const y = 1 - yP * j;
                pos.push(x, y, 0);
                normal.push(0, 0, 1);
                uv.push(x / 2 + 0.5, 1 - y / 2 - 0.5);
            }
        }
        for (let i = 0; i < divX; i++) {
            for (let j = 0; j < divY; j++) {
                const p0 = i * (divY + 1) + j + startIndex;
                const p1 = p0 + 1;
                const p3 = p0 + divY + 1;
                const p2 = p3 + 1;
                index.push(p0, p1, p3, p3, p1, p2);
            }
        }
    }
    static addQuad(pos, normal, uv, index, points) {
        const startIndex = pos.length / 3;
        const v0 = points[0], v1 = points[1], v3 = points[2];
        const v02v1 = v1.subtractWith(v0);
        const v02v3 = v3.subtractWith(v0);
        const v2 = v0.addWith(v02v1).addWith(v02v3);
        const nV = v02v1.crossWith(v02v3).normalizeThis();
        normal.push(nV.X, nV.Y, nV.Z, nV.X, nV.Y, nV.Z, nV.X, nV.Y, nV.Z, nV.X, nV.Y, nV.Z);
        uv.push(0, 1, 0, 0, 1, 0, 1, 1);
        pos.push(v0.X, v0.Y, v0.Z, v1.X, v1.Y, v1.Z, v2.X, v2.Y, v2.Z, v3.X, v3.Y, v3.Z);
        index.push(startIndex, startIndex + 1, startIndex + 3, startIndex + 3, startIndex + 1, startIndex + 2);
    }
    static addCircle(pos, normal, uv, index, divide, center, normalVector, tangentVector) {
        const tan2 = Vector3.cross(tangentVector, normalVector);
        const vecCount = 2 + divide;
        const baseIndex = uv.length / 2;
        for (let i = 0; i < vecCount; i++) {
            const v = GeometryBuilder._calcNextPointInCircle(i, divide, center, tangentVector, tan2);
            const u = GeometryBuilder._calcUVInCircle(i, divide);
            pos.push(v.X, v.Y, v.Z);
            normal.push(normalVector.X, normalVector.Y, normalVector.Z);
            uv.push(u[0], u[1]);
        }
        for (let i = 0; i < divide; i++) {
            index.push(baseIndex);
            index.push(baseIndex + i + 2);
            index.push(baseIndex + i + 1);
        }
    }
    static addCylinder(pos, normal, uv, index, divide, start, end, tangent, radius) {
        const dest = Vector3.subtract(end, start);
        let tangentNormalized = tangent.normalizeThis();
        let tan2 = Vector3.cross(dest.normalizeThis(), tangentNormalized);
        tangentNormalized = tangentNormalized.multiplyWith(radius);
        tan2 = tan2.multiplyWith(radius);
        for (let i = 0; i < divide; i++) {
            const angle = (i - 1) * 2 * Math.PI / divide;
            const angleTo = i * 2 * Math.PI / divide;
            const currentNormal = Vector3.add(tan2.multiplyWith(Math.cos(angle)), tangentNormalized.multiplyWith(Math.sin(angle)));
            const nextNormal = Vector3.add(tan2.multiplyWith(Math.cos(angleTo)), tangentNormalized.multiplyWith(Math.sin(angleTo)));
            const v0 = Vector3.add(start, currentNormal);
            const v1 = Vector3.add(start, nextNormal);
            const v2 = Vector3.add(v0, dest);
            const v3 = v1.addWith(dest);
            const startIndex = pos.length / 3;
            normal.push(currentNormal.X, currentNormal.Y, currentNormal.Z, nextNormal.X, nextNormal.Y, nextNormal.Z, nextNormal.X, nextNormal.Y, nextNormal.Z, currentNormal.X, currentNormal.Y, currentNormal.Z);
            uv.push(0, 1, 1, 0, 1, 0, 0, 0);
            pos.push(v0.X, v0.Y, v0.Z, v1.X, v1.Y, v1.Z, v3.X, v3.Y, v3.Z, v2.X, v2.Y, v2.Z);
            index.push(startIndex + 2, startIndex + 1, startIndex, startIndex + 3, startIndex + 2, startIndex);
        }
    }
    static addSphere(pos, normal, uv, index, divide1, divide2, center) {
        const vt = Vector3.add(center, new Vector3(0, 1, 0));
        const vb = Vector3.add(center, new Vector3(0, -1, 0));
        pos.push(vt.X, vt.Y, vt.Z);
        normal.push(0, 1, 0);
        uv.push(0, 1);
        for (let i = 0; i < divide1 - 1; i++) {
            const angle_y = (i + 1) * Math.PI / divide1;
            const d = Math.sin(angle_y);
            const h = Math.cos(angle_y);
            for (let j = 0; j < divide2; j++) {
                const angle_x = j * 2 * Math.PI / divide2;
                const v0 = new Vector3(d * Math.sin(angle_x), h, d * Math.cos(angle_x));
                const v0_n = v0.normalizeThis();
                const startIndex = pos.length / 3;
                pos.push(v0.X, v0.Y, v0.Z);
                normal.push(v0_n.X, v0_n.Y, v0_n.Z);
                uv.push(0, 1);
                if (i === 0) {
                    if (j !== 0) {
                        index.push(0, startIndex - 1, startIndex);
                        if (j === divide2 - 1) {
                            index.push(0, startIndex, 1);
                        }
                    }
                }
                else {
                    if (j === 0) {
                        index.push(startIndex - divide2, startIndex, startIndex - divide2 + 1);
                    }
                    else if (j === divide2 - 1) {
                        index.push(startIndex - divide2, startIndex - 1, startIndex);
                        index.push(startIndex - divide2 + 1, startIndex - divide2 - divide2 + 1, startIndex);
                        index.push(startIndex - divide2 - divide2 + 1, startIndex - divide2, startIndex);
                    }
                    else {
                        index.push(startIndex - divide2, startIndex - 1, startIndex);
                        index.push(startIndex - divide2 + 1, startIndex - divide2, startIndex);
                    }
                }
            }
        }
        const startIndex = pos.length / 3;
        pos.push(vb.X, vb.Y, vb.Z);
        normal.push(0, -1, 0);
        uv.push(0, 1);
        for (let j = 0; j < divide2 - 1; j++) {
            index.push(startIndex, startIndex - 1 - j, startIndex - 2 - j);
        }
        index.push(startIndex, startIndex - divide2, startIndex - 1);
    }
    static addCone(pos, normal, uv, index, divide) {
        pos.push(0, -1, 0);
        normal.push(0, -1, 0);
        uv.push(0, 1);
        const angle = 2 * Math.PI / divide;
        const y = Math.sqrt(5) / 5.0;
        const k = y * 2;
        let startIndex;
        for (let i = 0; i < divide; i++) {
            const d1 = Math.sin(angle * i);
            const d2 = Math.cos(angle * i);
            const v = new Vector3(d1, -1, d2);
            const vn = new Vector3(d1 * k, y, d2 * k);
            startIndex = pos.length / 3;
            pos.push(v.X, v.Y, v.Z, v.X, v.Y, v.Z, 0, 1, 0);
            uv.push(0, 1, 0, 1, 0, 1);
            normal.push(vn.X, vn.Y, vn.Z, 0, -1, 0, vn.X, vn.Y, vn.Z);
            if (i !== 0) {
                index.push(startIndex - 1, startIndex - 3, startIndex);
                index.push(0, startIndex + 1, startIndex - 2);
            }
        }
        startIndex = pos.length / 3 - 1;
        index.push(startIndex, startIndex - 2, 1);
        index.push(0, 2, startIndex - 1);
    }
    static _calcUVInCircle(index, divCount) {
        if (index === 0) {
            return [0, 0];
        }
        const angle = (index - 1) * 2 * Math.PI / divCount;
        return [Math.cos(angle), Math.sin(angle)];
    }
    static _calcNextPointInCircle(index, divCount, center, tan, tan2) {
        const angle = (index - 1) * 2 * Math.PI / divCount;
        return index === 0 ? center :
            Vector3.add(center, Vector3.add(tan.multiplyWith(Math.sin(angle)), tan2.multiplyWith(Math.cos(angle))));
    }
}
export default GeometryBuilder;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkNvcmUvR2VvbWV0cmllcy9CYXNlL0dlb21ldHJ5QnVpbGRlci50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiT0FBTyxPQUFPLE1BQU0sdUJBQXVCO0FBQzNDO0lBQ0UsT0FBYyxjQUFjLENBQUMsR0FBYSxFQUFFLE1BQWdCLEVBQUUsRUFBWSxFQUFFLEtBQWUsRUFBRSxJQUFZLEVBQUUsSUFBWTtRQUNySCxNQUFNLFVBQVUsR0FBRyxHQUFHLENBQUMsTUFBTSxHQUFHLENBQUMsQ0FBQztRQUNsQyxNQUFNLEVBQUUsR0FBRyxHQUFHLEdBQUcsSUFBSSxDQUFDO1FBQ3RCLE1BQU0sRUFBRSxHQUFHLEdBQUcsR0FBRyxJQUFJLENBQUM7UUFDdEIsR0FBRyxDQUFDLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsR0FBRyxJQUFJLEdBQUcsQ0FBQyxFQUFFLENBQUMsRUFBRSxFQUFFLENBQUM7WUFDbEMsTUFBTSxDQUFDLEdBQUcsRUFBRSxHQUFHLENBQUMsR0FBRyxDQUFDLENBQUM7WUFDckIsR0FBRyxDQUFDLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsR0FBRyxJQUFJLEdBQUcsQ0FBQyxFQUFFLENBQUMsRUFBRSxFQUFFLENBQUM7Z0JBQ2xDLE1BQU0sQ0FBQyxHQUFHLENBQUMsR0FBRyxFQUFFLEdBQUcsQ0FBQyxDQUFDO2dCQUNyQixHQUFHLENBQUMsSUFBSSxDQUFDLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUM7Z0JBQ2xCLE1BQU0sQ0FBQyxJQUFJLENBQUMsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQztnQkFDckIsRUFBRSxDQUFDLElBQUksQ0FBQyxDQUFDLEdBQUcsQ0FBQyxHQUFHLEdBQUcsRUFBRSxDQUFDLEdBQUcsQ0FBQyxHQUFHLENBQUMsR0FBRyxHQUFHLENBQUMsQ0FBQztZQUN4QyxDQUFDO1FBQ0gsQ0FBQztRQUNELEdBQUcsQ0FBQyxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsSUFBSSxFQUFFLENBQUMsRUFBRSxFQUFFLENBQUM7WUFDOUIsR0FBRyxDQUFDLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsR0FBRyxJQUFJLEVBQUUsQ0FBQyxFQUFFLEVBQUUsQ0FBQztnQkFDOUIsTUFBTSxFQUFFLEdBQUcsQ0FBQyxHQUFHLENBQUMsSUFBSSxHQUFHLENBQUMsQ0FBQyxHQUFHLENBQUMsR0FBRyxVQUFVLENBQUM7Z0JBQzNDLE1BQU0sRUFBRSxHQUFHLEVBQUUsR0FBRyxDQUFDLENBQUM7Z0JBQ2xCLE1BQU0sRUFBRSxHQUFHLEVBQUUsR0FBRyxJQUFJLEdBQUcsQ0FBQyxDQUFDO2dCQUN6QixNQUFNLEVBQUUsR0FBRyxFQUFFLEdBQUcsQ0FBQyxDQUFDO2dCQUNsQixLQUFLLENBQUMsSUFBSSxDQUFDLEVBQUUsRUFBRSxFQUFFLEVBQUUsRUFBRSxFQUFFLEVBQUUsRUFBRSxFQUFFLEVBQUUsRUFBRSxDQUFDLENBQUM7WUFDckMsQ0FBQztRQUNILENBQUM7SUFDSCxDQUFDO0lBQ0QsT0FBYyxPQUFPLENBQUMsR0FBYSxFQUFFLE1BQWdCLEVBQUUsRUFBWSxFQUFFLEtBQWUsRUFBRSxNQUFpQjtRQUNyRyxNQUFNLFVBQVUsR0FBRyxHQUFHLENBQUMsTUFBTSxHQUFHLENBQUMsQ0FBQztRQUNsQyxNQUFNLEVBQUUsR0FBRyxNQUFNLENBQUMsQ0FBQyxDQUFDLEVBQUUsRUFBRSxHQUFHLE1BQU0sQ0FBQyxDQUFDLENBQUMsRUFBRSxFQUFFLEdBQUcsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQ3JELE1BQU0sS0FBSyxHQUFHLEVBQUUsQ0FBQyxZQUFZLENBQUMsRUFBRSxDQUFDLENBQUM7UUFDbEMsTUFBTSxLQUFLLEdBQUcsRUFBRSxDQUFDLFlBQVksQ0FBQyxFQUFFLENBQUMsQ0FBQztRQUNsQyxNQUFNLEVBQUUsR0FBRyxFQUFFLENBQUMsT0FBTyxDQUFDLEtBQUssQ0FBQyxDQUFDLE9BQU8sQ0FBQyxLQUFLLENBQUMsQ0FBQztRQUM1QyxNQUFNLEVBQUUsR0FBRyxLQUFLLENBQUMsU0FBUyxDQUFDLEtBQUssQ0FBQyxDQUFDLGFBQWEsRUFBRSxDQUFDO1FBQ2xELE1BQU0sQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDLENBQUMsRUFBRSxFQUFFLENBQUMsQ0FBQyxFQUFFLEVBQUUsQ0FBQyxDQUFDLEVBQUUsRUFBRSxDQUFDLENBQUMsRUFBRSxFQUFFLENBQUMsQ0FBQyxFQUFFLEVBQUUsQ0FBQyxDQUFDLEVBQUUsRUFBRSxDQUFDLENBQUMsRUFBRSxFQUFFLENBQUMsQ0FBQyxFQUFFLEVBQUUsQ0FBQyxDQUFDLEVBQUUsRUFBRSxDQUFDLENBQUMsRUFBRSxFQUFFLENBQUMsQ0FBQyxFQUFFLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUNwRixFQUFFLENBQUMsSUFBSSxDQUFDLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQztRQUNoQyxHQUFHLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxDQUFDLEVBQUUsRUFBRSxDQUFDLENBQUMsRUFBRSxFQUFFLENBQUMsQ0FBQyxFQUFFLEVBQUUsQ0FBQyxDQUFDLEVBQUUsRUFBRSxDQUFDLENBQUMsRUFBRSxFQUFFLENBQUMsQ0FBQyxFQUFFLEVBQUUsQ0FBQyxDQUFDLEVBQUUsRUFBRSxDQUFDLENBQUMsRUFBRSxFQUFFLENBQUMsQ0FBQyxFQUFFLEVBQUUsQ0FBQyxDQUFDLEVBQUUsRUFBRSxDQUFDLENBQUMsRUFBRSxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDakYsS0FBSyxDQUFDLElBQUksQ0FBQyxVQUFVLEVBQUUsVUFBVSxHQUFHLENBQUMsRUFBRSxVQUFVLEdBQUcsQ0FBQyxFQUFFLFVBQVUsR0FBRyxDQUFDLEVBQUUsVUFBVSxHQUFHLENBQUMsRUFBRSxVQUFVLEdBQUcsQ0FBQyxDQUFDLENBQUM7SUFDekcsQ0FBQztJQUVELE9BQWMsU0FBUyxD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QztZQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQztRQUFDLENBQUM7UUFDbkMsTUFBTSxLQUFLLEdBQUcsQ0FBQyxLQUFLLEdBQUcsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxHQUFHLElBQUksQ0FBQyxFQUFFLEdBQUcsUUFBUSxDQUFDO1FBQ25ELE1BQU0sQ0FBQyxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsS0FBSyxDQUFDLEVBQUUsSUFBSSxDQUFDLEdBQUcsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDO0lBQzVDLENBQUM7SUFFRCxPQUFlLHNCQUFzQixDQUFDLEtBQWEsRUFBRSxRQUFnQixFQUFFLE1BQWUsRUFBRSxHQUFZLEVBQUUsSUFBYTtRQUNqSCxNQUFNLEtBQUssR0FBRyxDQUFDLEtBQUssR0FBRyxDQUFDLENBQUMsR0FBRyxDQUFDLEdBQUcsSUFBSSxDQUFDLEVBQUUsR0FBRyxRQUFRLENBQUM7UUFDbkQsTUFBTSxDQUFDLEtBQUssS0FBSyxDQUFDLEdBQUcsTUFBTTtZQUN6QixPQUFPLENBQUMsR0FBRyxDQUFDLE1BQU0sRUFBRSxPQUFPLENBQUMsR0FBRyxDQUFDLEdBQUcsQ0FBQyxZQUFZLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxLQUFLLENBQUMsQ0FBQyxFQUFFLElBQUksQ0FBQyxZQUFZLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztJQUM1RyxDQUFDO0FBQ0gsQ0FBQztBQUVELGVBQWUsZUFBZSxDQUFDIiwiZmlsZSI6IkNvcmUvR2VvbWV0cmllcy9CYXNlL0dlb21ldHJ5QnVpbGRlci5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBWZWN0b3IzIGZyb20gXCIuLi8uLi8uLi9NYXRoL1ZlY3RvcjNcIjtcbmNsYXNzIEdlb21ldHJ5QnVpbGRlciB7XG4gIHB1YmxpYyBzdGF0aWMgYWRkRGl2aWRlZFF1YWQocG9zOiBudW1iZXJbXSwgbm9ybWFsOiBudW1iZXJbXSwgdXY6IG51bWJlcltdLCBpbmRleDogbnVtYmVyW10sIGRpdlg6IG51bWJlciwgZGl2WTogbnVtYmVyKTogdm9pZCB7XG4gICAgY29uc3Qgc3RhcnRJbmRleCA9IHBvcy5sZW5ndGggLyAzO1xuICAgIGNvbnN0IHhQID0gMi4wIC8gZGl2WDtcbiAgICBjb25zdCB5UCA9IDIuMCAvIGRpdlk7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBkaXZYICsgMTsgaSsrKSB7XG4gICAgICBjb25zdCB4ID0geFAgKiBpIC0gMTtcbiAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgZGl2WSArIDE7IGorKykge1xuICAgICAgICBjb25zdCB5ID0gMSAtIHlQICogajtcbiAgICAgICAgcG9zLnB1c2goeCwgeSwgMCk7XG4gICAgICAgIG5vcm1hbC5wdXNoKDAsIDAsIDEpO1xuICAgICAgICB1di5wdXNoKHggLyAyICsgMC41LCAxIC0geSAvIDIgLSAwLjUpO1xuICAgICAgfVxuICAgIH1cbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGRpdlg7IGkrKykge1xuICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCBkaXZZOyBqKyspIHtcbiAgICAgICAgY29uc3QgcDAgPSBpICogKGRpdlkgKyAxKSArIGogKyBzdGFydEluZGV4O1xuICAgICAgICBjb25zdCBwMSA9IHAwICsgMTtcbiAgICAgICAgY29uc3QgcDMgPSBwMCArIGRpdlkgKyAxO1xuICAgICAgICBjb25zdCBwMiA9IHAzICsgMTtcbiAgICAgICAgaW5kZXgucHVzaChwMCwgcDEsIHAzLCBwMywgcDEsIHAyKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cbiAgcHVibGljIHN0YXRpYyBhZGRRdWFkKHBvczogbnVtYmVyW10sIG5vcm1hbDogbnVtYmVyW10sIHV2OiBudW1iZXJbXSwgaW5kZXg6IG51bWJlcltdLCBwb2ludHM6IFZlY3RvcjNbXSk6IHZvaWQge1xuICAgIGNvbnN0IHN0YXJ0SW5kZXggPSBwb3MubGVuZ3RoIC8gMztcbiAgICBjb25zdCB2MCA9IHBvaW50c1swXSwgdjEgPSBwb2ludHNbMV0sIHYzID0gcG9pbnRzWzJdO1xuICAgIGNvbnN0IHYwMnYxID0gdjEuc3VidHJhY3RXaXRoKHYwKTtcbiAgICBjb25zdCB2MDJ2MyA9IHYzLnN1YnRyYWN0V2l0aCh2MCk7XG4gICAgY29uc3QgdjIgPSB2MC5hZGRXaXRoKHYwMnYxKS5hZGRXaXRoKHYwMnYzKTtcbiAgICBjb25zdCBuViA9IHYwMnYxLmNyb3NzV2l0aCh2MDJ2Mykubm9ybWFsaXplVGhpcygpO1xuICAgIG5vcm1hbC5wdXNoKG5WLlgsIG5WLlksIG5WLlosIG5WLlgsIG5WLlksIG5WLlosIG5WLlgsIG5WLlksIG5WLlosIG5WLlgsIG5WLlksIG5WLlopO1xuICAgIHV2LnB1c2goMCwgMSwgMCwgMCwgMSwgMCwgMSwgMSk7XG4gICAgcG9zLnB1c2godjAuWCwgdjAuWSwgdjAuWiwgdjEuWCwgdjEuWSwgdjEuWiwgdjIuWCwgdjIuWSwgdjIuWiwgdjMuWCwgdjMuWSwgdjMuWik7XG4gICAgaW5kZXgucHVzaChzdGFydEluZGV4LCBzdGFydEluZGV4ICsgMSwgc3RhcnRJbmRleCArIDMsIHN0YXJ0SW5kZXggKyAzLCBzdGFydEluZGV4ICsgMSwgc3RhcnRJbmRleCArIDIpO1xuICB9XG5cbiAgcHVibGljIHN0YXRpYyBhZGRDaXJjbGUocG9zOiBudW1iZXJbXSwgbm9ybWFsOiBudW1iZXJbXSwgdXY6IG51bWJlcltdLCBpbmRleDogbnVtYmVyW10sIGRpdmlkZTogbnVtYmVyLCBjZW50ZXI6IFZlY3RvcjMsIG5vcm1hbFZlY3RvcjogVmVjdG9yMywgdGFuZ2VudFZlY3RvcjogVmVjdG9yMyk6IHZvaWQge1xuICAgIGNvbnN0IHRhbjIgPSBWZWN0b3IzLmNyb3NzKHRhbmdlbnRWZWN0b3IsIG5vcm1hbFZlY3Rvcik7XG4gICAgY29uc3QgdmVjQ291bnQgPSAyICsgZGl2aWRlO1xuICAgIGNvbnN0IGJhc2VJbmRleCA9IHV2Lmxlbmd0aCAvIDI7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCB2ZWNDb3VudDsgaSsrKSB7XG4gICAgICBjb25zdCB2OiBWZWN0b3IzID0gR2VvbWV0cnlCdWlsZGVyLl9jYWxjTmV4dFBvaW50SW5DaXJjbGUoaSwgZGl2aWRlLCBjZW50ZXIsIHRhbmdlbnRWZWN0b3IsIHRhbjIpO1xuICAgICAgY29uc3QgdSA9IEdlb21ldHJ5QnVpbGRlci5fY2FsY1VWSW5DaXJjbGUoaSwgZGl2aWRlKTtcbiAgICAgIHBvcy5wdXNoKHYuWCwgdi5ZLCB2LlopO1xuICAgICAgbm9ybWFsLnB1c2gobm9ybWFsVmVjdG9yLlgsIG5vcm1hbFZlY3Rvci5ZLCBub3JtYWxWZWN0b3IuWik7XG4gICAgICB1di5wdXNoKHVbMF0sIHVbMV0pO1xuICAgIH1cbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGRpdmlkZTsgaSsrKSB7XG4gICAgICBpbmRleC5wdXNoKGJhc2VJbmRleCk7XG4gICAgICBpbmRleC5wdXNoKGJhc2VJbmRleCArIGkgKyAyKTtcbiAgICAgIGluZGV4LnB1c2goYmFzZUluZGV4ICsgaSArIDEpO1xuICAgIH1cbiAgfVxuXG4gIHB1YmxpYyBzdGF0aWMgYWRkQ3lsaW5kZXIocG9zOiBudW1iZXJbXSwgbm9ybWFsOiBudW1iZXJbXSwgdXY6IG51bWJlcltdLCBpbmRleDogbnVtYmVyW10sIGRpdmlkZTogbnVtYmVyLCBzdGFydDogVmVjdG9yMywgZW5kOiBWZWN0b3IzLCB0YW5nZW50OiBWZWN0b3IzLCByYWRpdXM6IG51bWJlcik6IHZvaWQge1xuICAgIGNvbnN0IGRlc3Q6IFZlY3RvcjMgPSBWZWN0b3IzLnN1YnRyYWN0KGVuZCwgc3RhcnQpO1xuICAgIGxldCB0YW5nZW50Tm9ybWFsaXplZDogVmVjdG9yMyA9IHRhbmdlbnQubm9ybWFsaXplVGhpcygpO1xuICAgIGxldCB0YW4yOiBWZWN0b3IzID0gVmVjdG9yMy5jcm9zcyhkZXN0Lm5vcm1hbGl6ZVRoaXMoKSwgdGFuZ2VudE5vcm1hbGl6ZWQpO1xuICAgIHRhbmdlbnROb3JtYWxpemVkID0gdGFuZ2VudE5vcm1hbGl6ZWQubXVsdGlwbHlXaXRoKHJhZGl1cyk7XG4gICAgdGFuMiA9IHRhbjIubXVsdGlwbHlXaXRoKHJhZGl1cyk7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBkaXZpZGU7IGkrKykge1xuICAgICAgY29uc3QgYW5nbGUgPSAoaSAtIDEpICogMiAqIE1hdGguUEkgLyBkaXZpZGU7XG4gICAgICBjb25zdCBhbmdsZVRvID0gaSAqIDIgKiBNYXRoLlBJIC8gZGl2aWRlO1xuICAgICAgY29uc3QgY3VycmVudE5vcm1hbCA9IFZlY3RvcjMuYWRkKHRhbjIubXVsdGlwbHlXaXRoKE1hdGguY29zKGFuZ2xlKSksIHRhbmdlbnROb3JtYWxpemVkLm11bHRpcGx5V2l0aChNYXRoLnNpbihhbmdsZSkpKTtcbiAgICAgIGNvbnN0IG5leHROb3JtYWwgPSBWZWN0b3IzLmFkZCh0YW4yLm11bHRpcGx5V2l0aChNYXRoLmNvcyhhbmdsZVRvKSksIHRhbmdlbnROb3JtYWxpemVkLm11bHRpcGx5V2l0aChNYXRoLnNpbihhbmdsZVRvKSkpO1xuICAgICAgY29uc3QgdjAgPSBWZWN0b3IzLmFkZChzdGFydCwgY3VycmVudE5vcm1hbCk7XG4gICAgICBjb25zdCB2MSA9IFZlY3RvcjMuYWRkKHN0YXJ0LCBuZXh0Tm9ybWFsKTtcbiAgICAgIGNvbnN0IHYyID0gVmVjdG9yMy5hZGQodjAsIGRlc3QpO1xuICAgICAgY29uc3QgdjMgPSB2MS5hZGRXaXRoKGRlc3QpO1xuICAgICAgY29uc3Qgc3RhcnRJbmRleCA9IHBvcy5sZW5ndGggLyAzO1xuICAgICAgbm9ybWFsLnB1c2goY3VycmVudE5vcm1hbC5YLCBjdXJyZW50Tm9ybWFsLlksIGN1cnJlbnROb3JtYWwuWixcbiAgICAgICAgbmV4dE5vcm1hbC5YLCBuZXh0Tm9ybWFsLlksIG5leHROb3JtYWwuWixcbiAgICAgICAgbmV4dE5vcm1hbC5YLCBuZXh0Tm9ybWFsLlksIG5leHROb3JtYWwuWixcbiAgICAgICAgY3VycmVudE5vcm1hbC5YLCBjdXJyZW50Tm9ybWFsLlksIGN1cnJlbnROb3JtYWwuWik7XG4gICAgICB1di5wdXNoKDAsIDEsIDEsIDAsIDEsIDAsIDAsIDApO1xuICAgICAgcG9zLnB1c2godjAuWCwgdjAuWSwgdjAuWiwgdjEuWCwgdjEuWSwgdjEuWiwgdjMuWCwgdjMuWSwgdjMuWiwgdjIuWCwgdjIuWSwgdjIuWik7XG4gICAgICBpbmRleC5wdXNoKHN0YXJ0SW5kZXggKyAyLCBzdGFydEluZGV4ICsgMSwgc3RhcnRJbmRleCwgc3RhcnRJbmRleCArIDMsIHN0YXJ0SW5kZXggKyAyLCBzdGFydEluZGV4KTtcbiAgICB9XG4gIH1cbiAgcHVibGljIHN0YXRpYyBhZGRTcGhlcmUocG9zOiBudW1iZXJbXSwgbm9ybWFsOiBudW1iZXJbXSwgdXY6IG51bWJlcltdLCBpbmRleDogbnVtYmVyW10sIGRpdmlkZTE6IG51bWJlciwgZGl2aWRlMjogbnVtYmVyLCBjZW50ZXI6IFZlY3RvcjMpOiB2b2lkIHtcbiAgICBjb25zdCB2dCA9IFZlY3RvcjMuYWRkKGNlbnRlciwgbmV3IFZlY3RvcjMoMCwgMSwgMCkpO1xuICAgIGNvbnN0IHZiID0gVmVjdG9yMy5hZGQoY2VudGVyLCBuZXcgVmVjdG9yMygwLCAtMSwgMCkpO1xuICAgIHBvcy5wdXNoKHZ0LlgsIHZ0LlksIHZ0LlopO1xuICAgIG5vcm1hbC5wdXNoKDAsIDEsIDApO1xuICAgIHV2LnB1c2goMCwgMSk7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBkaXZpZGUxIC0gMTsgaSsrKSB7XG4gICAgICBjb25zdCBhbmdsZV95ID0gKGkgKyAxKSAqIE1hdGguUEkgLyBkaXZpZGUxO1xuICAgICAgY29uc3QgZCA9IE1hdGguc2luKGFuZ2xlX3kpO1xuICAgICAgY29uc3QgaCA9IE1hdGguY29zKGFuZ2xlX3kpO1xuICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCBkaXZpZGUyOyBqKyspIHtcbiAgICAgICAgY29uc3QgYW5nbGVfeCA9IGogKiAyICogTWF0aC5QSSAvIGRpdmlkZTI7XG4gICAgICAgIGNvbnN0IHYwID0gbmV3IFZlY3RvcjMoZCAqIE1hdGguc2luKGFuZ2xlX3gpLCBoLCBkICogTWF0aC5jb3MoYW5nbGVfeCkpO1xuICAgICAgICBjb25zdCB2MF9uID0gdjAubm9ybWFsaXplVGhpcygpO1xuICAgICAgICBjb25zdCBzdGFydEluZGV4ID0gcG9zLmxlbmd0aCAvIDM7XG5cbiAgICAgICAgcG9zLnB1c2godjAuWCwgdjAuWSwgdjAuWik7XG4gICAgICAgIG5vcm1hbC5wdXNoKHYwX24uWCwgdjBfbi5ZLCB2MF9uLlopO1xuICAgICAgICB1di5wdXNoKDAsIDEpO1xuXG4gICAgICAgIGlmIChpID09PSAwKSB7XG4gICAgICAgICAgaWYgKGogIT09IDApIHtcbiAgICAgICAgICAgIGluZGV4LnB1c2goMCwgc3RhcnRJbmRleCAtIDEsIHN0YXJ0SW5kZXgpO1xuICAgICAgICAgICAgaWYgKGogPT09IGRpdmlkZTIgLSAxKSB7XG4gICAgICAgICAgICAgIGluZGV4LnB1c2goMCwgc3RhcnRJbmRleCwgMSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGlmIChqID09PSAwKSB7XG4gICAgICAgICAgICBpbmRleC5wdXNoKHN0YXJ0SW5kZXggLSBkaXZpZGUyLCBzdGFydEluZGV4LCBzdGFydEluZGV4IC0gZGl2aWRlMiArIDEpO1xuICAgICAgICAgIH0gZWxzZSBpZiAoaiA9PT0gZGl2aWRlMiAtIDEpIHtcbiAgICAgICAgICAgIGluZGV4LnB1c2goc3RhcnRJbmRleCAtIGRpdmlkZTIsIHN0YXJ0SW5kZXggLSAxLCBzdGFydEluZGV4KTtcbiAgICAgICAgICAgIGluZGV4LnB1c2goc3RhcnRJbmRleCAtIGRpdmlkZTIgKyAxLCBzdGFydEluZGV4IC0gZGl2aWRlMiAtIGRpdmlkZTIgKyAxLCBzdGFydEluZGV4KTtcbiAgICAgICAgICAgIGluZGV4LnB1c2goc3RhcnRJbmRleCAtIGRpdmlkZTIgLSBkaXZpZGUyICsgMSwgc3RhcnRJbmRleCAtIGRpdmlkZTIsIHN0YXJ0SW5kZXgpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBpbmRleC5wdXNoKHN0YXJ0SW5kZXggLSBkaXZpZGUyLCBzdGFydEluZGV4IC0gMSwgc3RhcnRJbmRleCk7XG4gICAgICAgICAgICBpbmRleC5wdXNoKHN0YXJ0SW5kZXggLSBkaXZpZGUyICsgMSwgc3RhcnRJbmRleCAtIGRpdmlkZTIsIHN0YXJ0SW5kZXgpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIGNvbnN0IHN0YXJ0SW5kZXggPSBwb3MubGVuZ3RoIC8gMztcbiAgICBwb3MucHVzaCh2Yi5YLCB2Yi5ZLCB2Yi5aKTtcbiAgICBub3JtYWwucHVzaCgwLCAtMSwgMCk7XG4gICAgdXYucHVzaCgwLCAxKTtcbiAgICBmb3IgKGxldCBqID0gMDsgaiA8IGRpdmlkZTIgLSAxOyBqKyspIHtcbiAgICAgIGluZGV4LnB1c2goc3RhcnRJbmRleCwgc3RhcnRJbmRleCAtIDEgLSBqLCBzdGFydEluZGV4IC0gMiAtIGopO1xuICAgIH1cbiAgICBpbmRleC5wdXNoKHN0YXJ0SW5kZXgsIHN0YXJ0SW5kZXggLSBkaXZpZGUyLCBzdGFydEluZGV4IC0gMSk7XG4gIH1cbiAgcHVibGljIHN0YXRpYyBhZGRDb25lKHBvczogbnVtYmVyW10sIG5vcm1hbDogbnVtYmVyW10sIHV2OiBudW1iZXJbXSwgaW5kZXg6IG51bWJlcltdLCBkaXZpZGU6IG51bWJlcik6IHZvaWQge1xuICAgIHBvcy5wdXNoKDAsIC0xLCAwKTtcbiAgICBub3JtYWwucHVzaCgwLCAtMSwgMCk7XG4gICAgdXYucHVzaCgwLCAxKTtcbiAgICBjb25zdCBhbmdsZSA9IDIgKiBNYXRoLlBJIC8gZGl2aWRlO1xuICAgIGNvbnN0IHkgPSBNYXRoLnNxcnQoNSkgLyA1LjA7XG4gICAgY29uc3QgayA9IHkgKiAyO1xuICAgIGxldCBzdGFydEluZGV4O1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZGl2aWRlOyBpKyspIHtcbiAgICAgIGNvbnN0IGQxID0gTWF0aC5zaW4oYW5nbGUgKiBpKTtcbiAgICAgIGNvbnN0IGQyID0gTWF0aC5jb3MoYW5nbGUgKiBpKTtcblxuICAgICAgY29uc3QgdiA9IG5ldyBWZWN0b3IzKGQxLCAtMSwgZDIpO1xuICAgICAgY29uc3Qgdm4gPSBuZXcgVmVjdG9yMyhkMSAqIGssIHksIGQyICogayk7XG5cbiAgICAgIHN0YXJ0SW5kZXggPSBwb3MubGVuZ3RoIC8gMztcbiAgICAgIHBvcy5wdXNoKHYuWCwgdi5ZLCB2LlosIHYuWCwgdi5ZLCB2LlosIDAsIDEsIDApO1xuICAgICAgdXYucHVzaCgwLCAxLCAwLCAxLCAwLCAxKTtcbiAgICAgIG5vcm1hbC5wdXNoKHZuLlgsIHZuLlksIHZuLlosIDAsIC0xLCAwLCB2bi5YLCB2bi5ZLCB2bi5aKTtcblxuICAgICAgaWYgKGkgIT09IDApIHtcbiAgICAgICAgaW5kZXgucHVzaChzdGFydEluZGV4IC0gMSwgc3RhcnRJbmRleCAtIDMsIHN0YXJ0SW5kZXgpO1xuICAgICAgICBpbmRleC5wdXNoKDAsIHN0YXJ0SW5kZXggKyAxLCBzdGFydEluZGV4IC0gMik7XG4gICAgICB9XG4gICAgfVxuICAgIHN0YXJ0SW5kZXggPSBwb3MubGVuZ3RoIC8gMyAtIDE7XG4gICAgaW5kZXgucHVzaChzdGFydEluZGV4LCBzdGFydEluZGV4IC0gMiwgMSk7XG4gICAgaW5kZXgucHVzaCgwLCAyLCBzdGFydEluZGV4IC0gMSk7XG4gIH1cblxuICBwcml2YXRlIHN0YXRpYyBfY2FsY1VWSW5DaXJjbGUoaW5kZXg6IG51bWJlciwgZGl2Q291bnQ6IG51bWJlcik6IG51bWJlcltdIHtcbiAgICBpZiAoaW5kZXggPT09IDApIHsgcmV0dXJuIFswLCAwXTsgfVxuICAgIGNvbnN0IGFuZ2xlID0gKGluZGV4IC0gMSkgKiAyICogTWF0aC5QSSAvIGRpdkNvdW50O1xuICAgIHJldHVybiBbTWF0aC5jb3MoYW5nbGUpLCBNYXRoLnNpbihhbmdsZSldO1xuICB9XG5cbiAgcHJpdmF0ZSBzdGF0aWMgX2NhbGNOZXh0UG9pbnRJbkNpcmNsZShpbmRleDogbnVtYmVyLCBkaXZDb3VudDogbnVtYmVyLCBjZW50ZXI6IFZlY3RvcjMsIHRhbjogVmVjdG9yMywgdGFuMjogVmVjdG9yMyk6IFZlY3RvcjMge1xuICAgIGNvbnN0IGFuZ2xlID0gKGluZGV4IC0gMSkgKiAyICogTWF0aC5QSSAvIGRpdkNvdW50O1xuICAgIHJldHVybiBpbmRleCA9PT0gMCA/IGNlbnRlciA6XG4gICAgICBWZWN0b3IzLmFkZChjZW50ZXIsIFZlY3RvcjMuYWRkKHRhbi5tdWx0aXBseVdpdGgoTWF0aC5zaW4oYW5nbGUpKSwgdGFuMi5tdWx0aXBseVdpdGgoTWF0aC5jb3MoYW5nbGUpKSkpO1xuICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IEdlb21ldHJ5QnVpbGRlcjtcbiJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==

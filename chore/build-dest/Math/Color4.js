import VectorBase from "./VectorBase";
import Vector4 from "./Vector4";
class Color4 extends VectorBase {
    constructor(r, g, b, a) {
        super();
        this.rawElements = [r, g, b, a];
    }
    /// Color parser for css like syntax
    static internalParse(color, isFirst, tryParse) {
        if (isFirst && Color4.colorTable[color]) {
            return Color4.internalParse(Color4.colorTable[color], false);
        }
        let m;
        if (isFirst) {
            m = color.match(/^#([0-9a-f]{3})$/i);
            // #fff
            if (m) {
                const s = m[1];
                return new Color4(parseInt(s.charAt(0), 16) / 0xf, parseInt(s.charAt(1), 16) / 0xf, parseInt(s.charAt(2), 16) / 0xf, 1);
            }
        }
        if (isFirst) {
            m = color.match(/^#([0-9a-f]{4})$/i);
            // #ffff
            if (m) {
                const s = m[1];
                return new Color4(parseInt(s.charAt(0), 16) / 0xf, parseInt(s.charAt(1), 16) / 0xf, parseInt(s.charAt(2), 16) / 0xf, parseInt(s.charAt(3), 16) / 0xf);
            }
        }
        // #ffffff
        m = color.match(/^#([0-9a-f]{6})$/i);
        if (m) {
            const s = m[1];
            return new Color4(parseInt(s.substr(0, 2), 16) / 0xff, parseInt(s.substr(2, 2), 16) / 0xff, parseInt(s.substr(4, 2), 16) / 0xff, 1);
        }
        // #ffffffff
        if (isFirst) {
            m = color.match(/^#([0-9a-f]{8})$/i);
            if (m) {
                const s = m[1];
                return new Color4(parseInt(s.substr(0, 2), 16) / 0xff, parseInt(s.substr(2, 2), 16) / 0xff, parseInt(s.substr(4, 2), 16) / 0xff, parseInt(s.substr(6, 2), 16) / 0xff);
            }
        }
        let n = color.match(/^rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)$/i);
        if (n && isFirst) {
            return new Color4(parseInt(n[1], 10) / 0xff, parseInt(n[2], 10) / 0xff, parseInt(n[3], 10) / 0xff, 1);
        }
        n = color.match(/^rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\,\s*(\d+)\s*\)$/i);
        if (n && isFirst) {
            let d = parseInt(n[4], 10);
            d = d <= 1 ? d : d / 0xff;
            return new Color4(parseInt(n[1], 10) / 0xff, parseInt(n[2], 10) / 0xff, parseInt(n[3], 10) / 0xff, parseInt(n[4], 10));
        }
        if (tryParse) {
            return undefined;
        }
        throw new Error("Unexpected color string" + color);
    }
    static parse(color, tryParse) {
        return Color4.internalParse(color, true, tryParse);
    }
    static equals(col1, col2) {
        return VectorBase.__elementEquals(col1, col2);
    }
    get R() {
        return this.rawElements[0];
    }
    get G() {
        return this.rawElements[1];
    }
    get B() {
        return this.rawElements[2];
    }
    get A() {
        return this.rawElements[3];
    }
    toVector() {
        return new Vector4(this.R, this.G, this.B, this.A);
    }
    get ElementCount() {
        return 4;
    }
    equalWith(col) {
        return Color4.equals(col, this);
    }
    toString() {
        return `rgba(${Math.round(this.R * 255)}, ${Math.round(this.G * 255)}, ${Math.round(this.B * 255)}, ${Math.round(this.A * 255)})`;
    }
    toDisplayString() {
        let st = "#";
        st += Math.round(this.R * 0xff).toString(16).toUpperCase();
        st += Math.round(this.G * 0xff).toString(16).toUpperCase();
        st += Math.round(this.B * 0xff).toString(16).toUpperCase();
        st += Math.round(this.A * 0xff).toString(16).toUpperCase();
        return `Color4(${this.R}, ${this.G}, ${this.B}, ${this.A}, ${st})`;
    }
}
Color4.colorTable = require("../static/color.json");
export default Color4;

//# sourceMappingURL=data:application/json;base64,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LENBQUMsSUFBSSxDQUFDLENBQUMsR0FBRyxHQUFHLENBQUUsS0FBSyxJQUFJLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxDQUFDLEdBQUcsR0FBRyxDQUFFLEdBQUcsQ0FBQztJQUN4SSxDQUFDO0lBRU0sZUFBZTtRQUNwQixJQUFJLEVBQUUsR0FBRyxHQUFHLENBQUM7UUFDYixFQUFFLElBQUksSUFBSSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsQ0FBQyxHQUFHLElBQUksQ0FBQyxDQUFDLFFBQVEsQ0FBQyxFQUFFLENBQUMsQ0FBQyxXQUFXLEVBQUUsQ0FBQztRQUMzRCxFQUFFLElBQUksSUFBSSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsQ0FBQyxHQUFHLElBQUksQ0FBQyxDQUFDLFFBQVEsQ0FBQyxFQUFFLENBQUMsQ0FBQyxXQUFXLEVBQUUsQ0FBQztRQUMzRCxFQUFFLElBQUksSUFBSSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsQ0FBQyxHQUFHLElBQUksQ0FBQyxDQUFDLFFBQVEsQ0FBQyxFQUFFLENBQUMsQ0FBQyxXQUFXLEVBQUUsQ0FBQztRQUMzRCxFQUFFLElBQUksSUFBSSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsQ0FBQyxHQUFHLElBQUksQ0FBQyxDQUFDLFFBQVEsQ0FBQyxFQUFFLENBQUMsQ0FBQyxXQUFXLEVBQUUsQ0FBQztRQUMzRCxNQUFNLENBQUMsVUFBVSxJQUFJLENBQUMsQ0FBQyxLQUFLLElBQUksQ0FBQyxDQUFDLEtBQUssSUFBSSxDQUFDLENBQUMsS0FBSyxJQUFJLENBQUMsQ0FBQyxLQUFLLEVBQUUsR0FBRyxDQUFDO0lBQ3JFLENBQUM7QUFDSCxDQUFDO0FBOUhlLGlCQUFVLEdBQThCLE9BQU8sQ0FBQyxzQkFBc0IsQ0FBQyxDQThIdEY7QUFFRCxlQUFlLE1BQU0sQ0FBQyIsImZpbGUiOiJNYXRoL0NvbG9yNC5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBWZWN0b3JCYXNlIGZyb20gXCIuL1ZlY3RvckJhc2VcIjtcbmltcG9ydCBWZWN0b3I0IGZyb20gXCIuL1ZlY3RvcjRcIjtcblxuY2xhc3MgQ29sb3I0IGV4dGVuZHMgVmVjdG9yQmFzZSB7XG5cbiAgcHVibGljIHN0YXRpYyBjb2xvclRhYmxlOiB7IFtrZXk6IHN0cmluZ106IHN0cmluZyB9ID0gcmVxdWlyZShcIi4uL3N0YXRpYy9jb2xvci5qc29uXCIpO1xuXG4gIGNvbnN0cnVjdG9yKHI6IG51bWJlciwgZzogbnVtYmVyLCBiOiBudW1iZXIsIGE6IG51bWJlcikge1xuICAgIHN1cGVyKCk7XG4gICAgdGhpcy5yYXdFbGVtZW50cyA9IFtyLCBnLCBiLCBhXTtcbiAgfVxuXG4gIC8vLyBDb2xvciBwYXJzZXIgZm9yIGNzcyBsaWtlIHN5bnRheFxuICBwdWJsaWMgc3RhdGljIGludGVybmFsUGFyc2UoY29sb3I6IHN0cmluZywgaXNGaXJzdDogYm9vbGVhbiwgdHJ5UGFyc2U/OiBib29sZWFuKTogQ29sb3I0IHtcbiAgICBpZiAoaXNGaXJzdCAmJiBDb2xvcjQuY29sb3JUYWJsZVtjb2xvcl0pIHtcbiAgICAgIHJldHVybiBDb2xvcjQuaW50ZXJuYWxQYXJzZShDb2xvcjQuY29sb3JUYWJsZVtjb2xvcl0sIGZhbHNlKTtcbiAgICB9XG4gICAgbGV0IG07XG4gICAgaWYgKGlzRmlyc3QpIHtcbiAgICAgIG0gPSBjb2xvci5tYXRjaCgvXiMoWzAtOWEtZl17M30pJC9pKTtcbiAgICAgIC8vICNmZmZcbiAgICAgIGlmIChtKSB7XG4gICAgICAgIGNvbnN0IHMgPSBtWzFdO1xuICAgICAgICByZXR1cm4gbmV3IENvbG9yNChcbiAgICAgICAgICBwYXJzZUludChzLmNoYXJBdCgwKSwgMTYpIC8gMHhmLFxuICAgICAgICAgIHBhcnNlSW50KHMuY2hhckF0KDEpLCAxNikgLyAweGYsXG4gICAgICAgICAgcGFyc2VJbnQocy5jaGFyQXQoMiksIDE2KSAvIDB4ZixcbiAgICAgICAgICAxXG4gICAgICAgICAgKTtcbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKGlzRmlyc3QpIHtcbiAgICAgIG0gPSBjb2xvci5tYXRjaCgvXiMoWzAtOWEtZl17NH0pJC9pKTtcbiAgICAgIC8vICNmZmZmXG4gICAgICBpZiAobSkge1xuICAgICAgICBjb25zdCBzID0gbVsxXTtcbiAgICAgICAgcmV0dXJuIG5ldyBDb2xvcjQoXG4gICAgICAgICAgcGFyc2VJbnQocy5jaGFyQXQoMCksIDE2KSAvIDB4ZixcbiAgICAgICAgICBwYXJzZUludChzLmNoYXJBdCgxKSwgMTYpIC8gMHhmLFxuICAgICAgICAgIHBhcnNlSW50KHMuY2hhckF0KDIpLCAxNikgLyAweGYsXG4gICAgICAgICAgcGFyc2VJbnQocy5jaGFyQXQoMyksIDE2KSAvIDB4ZlxuICAgICAgICAgICk7XG4gICAgICB9XG4gICAgfVxuICAgIC8vICNmZmZmZmZcbiAgICBtID0gY29sb3IubWF0Y2goL14jKFswLTlhLWZdezZ9KSQvaSk7XG4gICAgaWYgKG0pIHtcbiAgICAgIGNvbnN0IHMgPSBtWzFdO1xuICAgICAgcmV0dXJuIG5ldyBDb2xvcjQoXG4gICAgICAgIHBhcnNlSW50KHMuc3Vic3RyKDAsIDIpLCAxNikgLyAweGZmLFxuICAgICAgICBwYXJzZUludChzLnN1YnN0cigyLCAyKSwgMTYpIC8gMHhmZixcbiAgICAgICAgcGFyc2VJbnQocy5zdWJzdHIoNCwgMiksIDE2KSAvIDB4ZmYsXG4gICAgICAgIDFcbiAgICAgICAgKTtcbiAgICB9XG4gICAgLy8gI2ZmZmZmZmZmXG4gICAgaWYgKGlzRmlyc3QpIHtcbiAgICAgIG0gPSBjb2xvci5tYXRjaCgvXiMoWzAtOWEtZl17OH0pJC9pKTtcbiAgICAgIGlmIChtKSB7XG4gICAgICAgIGNvbnN0IHMgPSBtWzFdO1xuICAgICAgICByZXR1cm4gbmV3IENvbG9yNChcbiAgICAgICAgICBwYXJzZUludChzLnN1YnN0cigwLCAyKSwgMTYpIC8gMHhmZixcbiAgICAgICAgICBwYXJzZUludChzLnN1YnN0cigyLCAyKSwgMTYpIC8gMHhmZixcbiAgICAgICAgICBwYXJzZUludChzLnN1YnN0cig0LCAyKSwgMTYpIC8gMHhmZixcbiAgICAgICAgICBwYXJzZUludChzLnN1YnN0cig2LCAyKSwgMTYpIC8gMHhmZlxuICAgICAgICAgICk7XG4gICAgICB9XG4gICAgfVxuICAgIGxldCBuID0gY29sb3IubWF0Y2goL15yZ2JcXHMqXFwoXFxzKihcXGQrKVxccyosXFxzKihcXGQrKVxccyosXFxzKihcXGQrKVxccypcXCkkL2kpO1xuICAgIGlmIChuICYmIGlzRmlyc3QpIHtcbiAgICAgIHJldHVybiBuZXcgQ29sb3I0KHBhcnNlSW50KG5bMV0sIDEwKSAvIDB4ZmYsIHBhcnNlSW50KG5bMl0sIDEwKSAvIDB4ZmYsIHBhcnNlSW50KG5bM10sIDEwKSAvIDB4ZmYsIDEpO1xuICAgIH1cbiAgICBuID0gY29sb3IubWF0Y2goL15yZ2JhXFxzKlxcKFxccyooXFxkKylcXHMqLFxccyooXFxkKylcXHMqLFxccyooXFxkKylcXHMqXFwsXFxzKihcXGQrKVxccypcXCkkL2kpO1xuICAgIGlmIChuICYmIGlzRmlyc3QpIHtcbiAgICAgIGxldCBkID0gcGFyc2VJbnQobls0XSwgMTApO1xuICAgICAgZCA9IGQgPD0gMSA/IGQgOiBkIC8gMHhmZjtcbiAgICAgIHJldHVybiBuZXcgQ29sb3I0KHBhcnNlSW50KG5bMV0sIDEwKSAvIDB4ZmYsIHBhcnNlSW50KG5bMl0sIDEwKSAvIDB4ZmYsIHBhcnNlSW50KG5bM10sIDEwKSAvIDB4ZmYsIHBhcnNlSW50KG5bNF0sIDEwKSk7XG4gICAgfVxuICAgIGlmICh0cnlQYXJzZSkge1xuICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICB9XG4gICAgdGhyb3cgbmV3IEVycm9yKFwiVW5leHBlY3RlZCBjb2xvciBzdHJpbmdcIiArIGNvbG9yKTtcbiAgfVxuXG4gIHB1YmxpYyBzdGF0aWMgcGFyc2UoY29sb3I6IHN0cmluZywgdHJ5UGFyc2U/OiBib29sZWFuKTogQ29sb3I0IHtcbiAgICByZXR1cm4gQ29sb3I0LmludGVybmFsUGFyc2UoY29sb3IsIHRydWUsIHRyeVBhcnNlKTtcbiAgfVxuXG4gIHB1YmxpYyBzdGF0aWMgZXF1YWxzKGNvbDE6IENvbG9yNCwgY29sMjogQ29sb3I0KTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIFZlY3RvckJhc2UuX19lbGVtZW50RXF1YWxzKGNvbDEsIGNvbDIpO1xuICB9XG5cbiAgcHVibGljIGdldCBSKCk6IG51bWJlciB7XG4gICAgcmV0dXJuIHRoaXMucmF3RWxlbWVudHNbMF07XG4gIH1cblxuICBwdWJsaWMgZ2V0IEcoKTogbnVtYmVyIHtcbiAgICByZXR1cm4gdGhpcy5yYXdFbGVtZW50c1sxXTtcbiAgfVxuXG4gIHB1YmxpYyBnZXQgQigpOiBudW1iZXIge1xuICAgIHJldHVybiB0aGlzLnJhd0VsZW1lbnRzWzJdO1xuICB9XG5cbiAgcHVibGljIGdldCBBKCk6IG51bWJlciB7XG4gICAgcmV0dXJuIHRoaXMucmF3RWxlbWVudHNbM107XG4gIH1cbiAgcHVibGljIHRvVmVjdG9yKCk6IFZlY3RvcjQge1xuICAgIHJldHVybiBuZXcgVmVjdG9yNCh0aGlzLlIsIHRoaXMuRywgdGhpcy5CLCB0aGlzLkEpO1xuICB9XG5cbiAgcHVibGljIGdldCBFbGVtZW50Q291bnQoKTogbnVtYmVyIHtcbiAgICByZXR1cm4gNDtcbiAgfVxuXG4gIHB1YmxpYyBlcXVhbFdpdGgoY29sOiBDb2xvcjQpOiBib29sZWFuIHtcbiAgICByZXR1cm4gQ29sb3I0LmVxdWFscyhjb2wsIHRoaXMpO1xuICB9XG5cbiAgcHVibGljIHRvU3RyaW5nKCk6IHN0cmluZyB7XG4gICAgcmV0dXJuIGByZ2JhKCR7TWF0aC5yb3VuZCh0aGlzLlIgKiAyNTUpIH0sICR7TWF0aC5yb3VuZCh0aGlzLkcgKiAyNTUpIH0sICR7TWF0aC5yb3VuZCh0aGlzLkIgKiAyNTUpIH0sICR7TWF0aC5yb3VuZCh0aGlzLkEgKiAyNTUpIH0pYDtcbiAgfVxuXG4gIHB1YmxpYyB0b0Rpc3BsYXlTdHJpbmcoKTogc3RyaW5nIHtcbiAgICBsZXQgc3QgPSBcIiNcIjtcbiAgICBzdCArPSBNYXRoLnJvdW5kKHRoaXMuUiAqIDB4ZmYpLnRvU3RyaW5nKDE2KS50b1VwcGVyQ2FzZSgpO1xuICAgIHN0ICs9IE1hdGgucm91bmQodGhpcy5HICogMHhmZikudG9TdHJpbmcoMTYpLnRvVXBwZXJDYXNlKCk7XG4gICAgc3QgKz0gTWF0aC5yb3VuZCh0aGlzLkIgKiAweGZmKS50b1N0cmluZygxNikudG9VcHBlckNhc2UoKTtcbiAgICBzdCArPSBNYXRoLnJvdW5kKHRoaXMuQSAqIDB4ZmYpLnRvU3RyaW5nKDE2KS50b1VwcGVyQ2FzZSgpO1xuICAgIHJldHVybiBgQ29sb3I0KCR7dGhpcy5SfSwgJHt0aGlzLkd9LCAke3RoaXMuQn0sICR7dGhpcy5BfSwgJHtzdH0pYDtcbiAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBDb2xvcjQ7XG4iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=

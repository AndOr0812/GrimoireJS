import SceneObjectNodeBase from "./../../Goml/Nodes/SceneObjects/SceneObjectNodeBase";
import PMXModel from "../Core/PMXModel";
import JThreeContext from "../../JThreeContext";
import ContextComponents from "../../ContextComponents";
class PMXNode extends SceneObjectNodeBase {
    constructor() {
        super();
        this._pmxModel = null;
        this._pmxLoadingDeferred = JThreeContext.getContextComponent(ContextComponents.ResourceLoader).getResourceLoadingDeffered();
        this.attributes.defineAttribute({
            "src": {
                converter: "string",
                value: "",
                onchanged: (attr) => {
                    attr.done();
                }
            }
        });
    }
    get PMXModel() {
        return this._pmxModel;
    }
    get PMXModelReady() {
        return this.PMXModel != null;
    }
    __onMount() {
        super.__onMount();
        PMXModel.loadFromUrl(this.attributes.getValue("src"))
            .then((m) => {
            this._pmxModel = m;
            this.TargetSceneObject = this._pmxModel;
            this._pmxLoadingDeferred.resolve(null);
        });
    }
}
export default PMXNode;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIlBNWC9Hb21sL1BNWE5vZGUudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ik9BQU8sbUJBQW1CLE1BQU0scURBQXFEO09BQzlFLFFBQVEsTUFBTSxrQkFBa0I7T0FDaEMsYUFBYSxNQUFNLHFCQUFxQjtPQUN4QyxpQkFBaUIsTUFBTSx5QkFBeUI7QUFJdkQsc0JBQXNCLG1CQUFtQjtJQWF2QztRQUNFLE9BQU8sQ0FBQztRQWJGLGNBQVMsR0FBYSxJQUFJLENBQUM7UUFjakMsSUFBSSxDQUFDLG1CQUFtQixHQUFHLGFBQWEsQ0FBQyxtQkFBbUIsQ0FBaUIsaUJBQWlCLENBQUMsY0FBYyxDQUFDLENBQUMsMEJBQTBCLEVBQVEsQ0FBQztRQUNsSixJQUFJLENBQUMsVUFBVSxDQUFDLGVBQWUsQ0FBQztZQUM5QixLQUFLLEVBQUU7Z0JBQ0wsU0FBUyxFQUFFLFFBQVE7Z0JBQ25CLEtBQUssRUFBRSxFQUFFO2dCQUNULFNBQVMsRUFBRSxDQUFDLElBQUk7b0JBQ2QsSUFBSSxDQUFDLElBQUksRUFBRSxDQUFDO2dCQUNkLENBQUM7YUFDRjtTQUNGLENBQUMsQ0FBQztJQUNMLENBQUM7SUF0QkQsSUFBVyxRQUFRO1FBQ2pCLE1BQU0sQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDO0lBQ3hCLENBQUM7SUFFRCxJQUFXLGFBQWE7UUFDdEIsTUFBTSxDQUFDLElBQUksQ0FBQyxRQUFRLElBQUksSUFBSSxDQUFDO0lBQy9CLENBQUM7SUFrQlMsU0FBUztRQUNqQixLQUFLLENBQUMsU0FBUyxFQUFFLENBQUM7UUFDbEIsUUFBUSxDQUFDLFdBQVcsQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDLFFBQVEsQ0FBQyxLQUFLLENBQUMsQ0FBQzthQUNsRCxJQUFJLENBQUMsQ0FBQyxDQUFDO1lBQ1IsSUFBSSxDQUFDLFNBQVMsR0FBRyxDQUFDLENBQUM7WUFDbkIsSUFBSSxDQUFDLGlCQUFpQixHQUFHLElBQUksQ0FBQyxTQUFTLENBQUM7WUFDeEMsSUFBSSxDQUFDLG1CQUFtQixDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUN6QyxDQUFDLENBQUMsQ0FBQztJQUNMLENBQUM7QUFDSCxDQUFDO0FBRUQsZUFBZSxPQUFPLENBQUMiLCJmaWxlIjoiUE1YL0dvbWwvUE1YTm9kZS5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBTY2VuZU9iamVjdE5vZGVCYXNlIGZyb20gXCIuLy4uLy4uL0dvbWwvTm9kZXMvU2NlbmVPYmplY3RzL1NjZW5lT2JqZWN0Tm9kZUJhc2VcIjtcbmltcG9ydCBQTVhNb2RlbCBmcm9tIFwiLi4vQ29yZS9QTVhNb2RlbFwiO1xuaW1wb3J0IEpUaHJlZUNvbnRleHQgZnJvbSBcIi4uLy4uL0pUaHJlZUNvbnRleHRcIjtcbmltcG9ydCBDb250ZXh0Q29tcG9uZW50cyBmcm9tIFwiLi4vLi4vQ29udGV4dENvbXBvbmVudHNcIjtcbmltcG9ydCBSZXNvdXJjZUxvYWRlciBmcm9tIFwiLi4vLi4vQ29yZS9SZXNvdXJjZUxvYWRlclwiO1xuaW1wb3J0IFEgZnJvbSBcInFcIjtcblxuY2xhc3MgUE1YTm9kZSBleHRlbmRzIFNjZW5lT2JqZWN0Tm9kZUJhc2U8UE1YTW9kZWw+IHtcbiAgcHJpdmF0ZSBfcG14TW9kZWw6IFBNWE1vZGVsID0gbnVsbDtcblxuICBwdWJsaWMgZ2V0IFBNWE1vZGVsKCkge1xuICAgIHJldHVybiB0aGlzLl9wbXhNb2RlbDtcbiAgfVxuXG4gIHB1YmxpYyBnZXQgUE1YTW9kZWxSZWFkeSgpIHtcbiAgICByZXR1cm4gdGhpcy5QTVhNb2RlbCAhPSBudWxsO1xuICB9XG5cbiAgcHJpdmF0ZSBfcG14TG9hZGluZ0RlZmVycmVkOiBRLkRlZmVycmVkPHZvaWQ+O1xuXG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHN1cGVyKCk7XG4gICAgdGhpcy5fcG14TG9hZGluZ0RlZmVycmVkID0gSlRocmVlQ29udGV4dC5nZXRDb250ZXh0Q29tcG9uZW50PFJlc291cmNlTG9hZGVyPihDb250ZXh0Q29tcG9uZW50cy5SZXNvdXJjZUxvYWRlcikuZ2V0UmVzb3VyY2VMb2FkaW5nRGVmZmVyZWQ8dm9pZD4oKTtcbiAgICB0aGlzLmF0dHJpYnV0ZXMuZGVmaW5lQXR0cmlidXRlKHtcbiAgICAgIFwic3JjXCI6IHtcbiAgICAgICAgY29udmVydGVyOiBcInN0cmluZ1wiLFxuICAgICAgICB2YWx1ZTogXCJcIixcbiAgICAgICAgb25jaGFuZ2VkOiAoYXR0cikgPT4ge1xuICAgICAgICAgIGF0dHIuZG9uZSgpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSk7XG4gIH1cblxuICBwcm90ZWN0ZWQgX19vbk1vdW50KCk6IHZvaWQge1xuICAgIHN1cGVyLl9fb25Nb3VudCgpO1xuICAgIFBNWE1vZGVsLmxvYWRGcm9tVXJsKHRoaXMuYXR0cmlidXRlcy5nZXRWYWx1ZShcInNyY1wiKSlcbiAgICAgIC50aGVuKChtKSA9PiB7XG4gICAgICB0aGlzLl9wbXhNb2RlbCA9IG07XG4gICAgICB0aGlzLlRhcmdldFNjZW5lT2JqZWN0ID0gdGhpcy5fcG14TW9kZWw7XG4gICAgICB0aGlzLl9wbXhMb2FkaW5nRGVmZXJyZWQucmVzb2x2ZShudWxsKTtcbiAgICB9KTtcbiAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBQTVhOb2RlO1xuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9

class BezierCurve {
    constructor(v1x, v1y, v2x, v2y) {
        this._v1x = v1x;
        this._v1y = v1y;
        this._v2x = v2x;
        this._v2y = v2y;
    }
    evaluate(progress) {
        // Newton method
        let t = this._clamp(progress, 0, 1);
        let dt;
        do {
            dt = -(this._fx(t) - progress) / this._dfxdt(t);
            if (isNaN(dt)) {
                break;
            }
            t += this._clamp(dt, -1, 1);
        } while (Math.abs(dt) > BezierCurve._epsilon);
        return this._clamp(this._fy(t), 0, 1);
    }
    _fy(t) {
        // _fy(t)=(1-t)^3*0+3*(1-t)^2*t*v1.y+3*(1-t)*t^2*v2.y+t^3*1
        return 3 * (1 - t) * (1 - t) * t * this._v1y + 3 * (1 - t) * t * t * this._v2y + t * t * t;
    }
    _fx(t) {
        // fx(t)=(1-t)^3*0+3*(1-t)^2*t*v1.x+3*(1-t)*t^2*v2.x+t^3*1
        return 3 * (1 - t) * (1 - t) * t * this._v1x + 3 * (1 - t) * t * t * this._v2x + t * t * t;
    }
    _dfxdt(t) {
        // dfx(t)/dt=-6(1-t)*t*v1.x+3(1-t)^2*v1.x-3t^2*v2.x+6(1-t)*t*v2.x+3t^2
        return -6 * (1 - t) * t * this._v1x + 3 * (1 - t) * (1 - t) * this._v1x - 3 * t * t * this._v2x + 6 * (1 - t) * t * this._v2x + 3 * t * t;
    }
    _clamp(p, min, max) {
        return Math.max(min, Math.min(p, max));
    }
}
BezierCurve._epsilon = 1.0E-3;
export default BezierCurve;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIlZNRC9QYXJzZXIvQmV6aWVyQ3VydmUudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7SUFXRSxZQUFZLEdBQVcsRUFBRSxHQUFXLEVBQUUsR0FBVyxFQUFFLEdBQVc7UUFDNUQsSUFBSSxDQUFDLElBQUksR0FBRyxHQUFHLENBQUM7UUFDaEIsSUFBSSxDQUFDLElBQUksR0FBRyxHQUFHLENBQUM7UUFDaEIsSUFBSSxDQUFDLElBQUksR0FBRyxHQUFHLENBQUM7UUFDaEIsSUFBSSxDQUFDLElBQUksR0FBRyxHQUFHLENBQUM7SUFDbEIsQ0FBQztJQUVNLFFBQVEsQ0FBQyxRQUFnQjtRQUM5QixnQkFBZ0I7UUFDaEIsSUFBSSxDQUFDLEdBQUcsSUFBSSxDQUFDLE1BQU0sQ0FBQyxRQUFRLEVBQUUsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDO1FBQ3BDLElBQUksRUFBRSxDQUFDO1FBQ1AsR0FBRyxDQUFDO1lBQ0YsRUFBRSxHQUFHLENBQUMsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxHQUFHLFFBQVEsQ0FBQyxHQUFHLElBQUksQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFDaEQsRUFBRSxDQUFDLENBQUMsS0FBSyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQztnQkFDZCxLQUFLLENBQUM7WUFDUixDQUFDO1lBQ0QsQ0FBQyxJQUFJLElBQUksQ0FBQyxNQUFNLENBQUMsRUFBRSxFQUFFLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDO1FBQzlCLENBQUMsUUFBUSxJQUFJLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxHQUFHLFdBQVcsQ0FBQyxRQUFRLEVBQUU7UUFDOUMsTUFBTSxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUM7SUFDeEMsQ0FBQztJQUVPLEdBQUcsQ0FBQyxDQUFTO1FBQ25CLDJEQUEyRDtRQUMzRCxNQUFNLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxHQUFHLENBQUMsR0FBRyxJQUFJLENBQUMsSUFBSSxHQUFHLENBQUMsR0FBRyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsR0FBRyxDQUFDLEdBQUcsQ0FBQyxHQUFHLElBQUksQ0FBQyxJQUFJLEdBQUcsQ0FBQyxHQUFHLENBQUMsR0FBRyxDQUFDLENBQUM7SUFDN0YsQ0FBQztJQUVPLEdBQUcsQ0FBQyxDQUFTO1FBQ25CLDBEQUEwRDtRQUMxRCxNQUFNLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxHQUFHLENBQUMsR0FBRyxJQUFJLENBQUMsSUFBSSxHQUFHLENBQUMsR0FBRyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsR0FBRyxDQUFDLEdBQUcsQ0FBQyxHQUFHLElBQUksQ0FBQyxJQUFJLEdBQUcsQ0FBQyxHQUFHLENBQUMsR0FBRyxDQUFDLENBQUM7SUFDN0YsQ0FBQztJQUVPLE1BQU0sQ0FBQyxDQUFTO1FBQ3RCLHNFQUFzRTtRQUN0RSxNQUFNLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxHQUFHLElBQUksQ0FBQyxJQUFJLEdBQUcsQ0FBQyxHQUFHLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxHQUFHLElBQUksQ0FBQyxJQUFJLEdBQUcsQ0FBQyxHQUFHLENBQUMsR0FBRyxDQUFDLEdBQUcsSUFBSSxDQUFDLElBQUksR0FBRyxDQUFDLEdBQUcsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxHQUFHLElBQUksQ0FBQyxJQUFJLEdBQUcsQ0FBQyxHQUFHLENBQUMsR0FBRyxDQUFDLENBQUM7SUFDNUksQ0FBQztJQUVPLE1BQU0sQ0FBQyxDQUFTLEVBQUUsR0FBVyxFQUFFLEdBQVc7UUFDaEQsTUFBTSxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsR0FBRyxFQUFFLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQyxFQUFFLEdBQUcsQ0FBQyxDQUFDLENBQUM7SUFDekMsQ0FBQztBQUNILENBQUM7QUFqRGdCLG9CQUFRLEdBQVcsTUFBTSxDQWlEekM7QUFFRCxlQUFlLFdBQVcsQ0FBQyIsImZpbGUiOiJWTUQvUGFyc2VyL0JlemllckN1cnZlLmpzIiwic291cmNlc0NvbnRlbnQiOlsiY2xhc3MgQmV6aWVyQ3VydmUge1xuICBwcml2YXRlIHN0YXRpYyBfZXBzaWxvbjogbnVtYmVyID0gMS4wRS0zO1xuXG4gIHByaXZhdGUgX3YxeDogbnVtYmVyO1xuXG4gIHByaXZhdGUgX3YyeDogbnVtYmVyO1xuXG4gIHByaXZhdGUgX3YxeTogbnVtYmVyO1xuXG4gIHByaXZhdGUgX3YyeTogbnVtYmVyO1xuXG4gIGNvbnN0cnVjdG9yKHYxeDogbnVtYmVyLCB2MXk6IG51bWJlciwgdjJ4OiBudW1iZXIsIHYyeTogbnVtYmVyKSB7XG4gICAgdGhpcy5fdjF4ID0gdjF4O1xuICAgIHRoaXMuX3YxeSA9IHYxeTtcbiAgICB0aGlzLl92MnggPSB2Mng7XG4gICAgdGhpcy5fdjJ5ID0gdjJ5O1xuICB9XG5cbiAgcHVibGljIGV2YWx1YXRlKHByb2dyZXNzOiBudW1iZXIpOiBudW1iZXIge1xuICAgIC8vIE5ld3RvbiBtZXRob2RcbiAgICBsZXQgdCA9IHRoaXMuX2NsYW1wKHByb2dyZXNzLCAwLCAxKTtcbiAgICBsZXQgZHQ7XG4gICAgZG8ge1xuICAgICAgZHQgPSAtKHRoaXMuX2Z4KHQpIC0gcHJvZ3Jlc3MpIC8gdGhpcy5fZGZ4ZHQodCk7XG4gICAgICBpZiAoaXNOYU4oZHQpKSB7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgICAgdCArPSB0aGlzLl9jbGFtcChkdCwgLTEsIDEpO1xuICAgIH0gd2hpbGUgKE1hdGguYWJzKGR0KSA+IEJlemllckN1cnZlLl9lcHNpbG9uKTtcbiAgICByZXR1cm4gdGhpcy5fY2xhbXAodGhpcy5fZnkodCksIDAsIDEpO1xuICB9XG5cbiAgcHJpdmF0ZSBfZnkodDogbnVtYmVyKTogbnVtYmVyIHtcbiAgICAvLyBfZnkodCk9KDEtdCleMyowKzMqKDEtdCleMip0KnYxLnkrMyooMS10KSp0XjIqdjIueSt0XjMqMVxuICAgIHJldHVybiAzICogKDEgLSB0KSAqICgxIC0gdCkgKiB0ICogdGhpcy5fdjF5ICsgMyAqICgxIC0gdCkgKiB0ICogdCAqIHRoaXMuX3YyeSArIHQgKiB0ICogdDtcbiAgfVxuXG4gIHByaXZhdGUgX2Z4KHQ6IG51bWJlcik6IG51bWJlciB7XG4gICAgLy8gZngodCk9KDEtdCleMyowKzMqKDEtdCleMip0KnYxLngrMyooMS10KSp0XjIqdjIueCt0XjMqMVxuICAgIHJldHVybiAzICogKDEgLSB0KSAqICgxIC0gdCkgKiB0ICogdGhpcy5fdjF4ICsgMyAqICgxIC0gdCkgKiB0ICogdCAqIHRoaXMuX3YyeCArIHQgKiB0ICogdDtcbiAgfVxuXG4gIHByaXZhdGUgX2RmeGR0KHQ6IG51bWJlcik6IG51bWJlciB7XG4gICAgLy8gZGZ4KHQpL2R0PS02KDEtdCkqdCp2MS54KzMoMS10KV4yKnYxLngtM3ReMip2Mi54KzYoMS10KSp0KnYyLngrM3ReMlxuICAgIHJldHVybiAtNiAqICgxIC0gdCkgKiB0ICogdGhpcy5fdjF4ICsgMyAqICgxIC0gdCkgKiAoMSAtIHQpICogdGhpcy5fdjF4IC0gMyAqIHQgKiB0ICogdGhpcy5fdjJ4ICsgNiAqICgxIC0gdCkgKiB0ICogdGhpcy5fdjJ4ICsgMyAqIHQgKiB0O1xuICB9XG5cbiAgcHJpdmF0ZSBfY2xhbXAocDogbnVtYmVyLCBtaW46IG51bWJlciwgbWF4OiBudW1iZXIpOiBudW1iZXIge1xuICAgIHJldHVybiBNYXRoLm1heChtaW4sIE1hdGgubWluKHAsIG1heCkpO1xuICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IEJlemllckN1cnZlO1xuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9

import Vector3 from "../../../Math/Vector3";
class GeometryBuilder {
    static addDividedQuad(pos, normal, uv, index, divX, divY) {
        const startIndex = pos.length / 3;
        const xP = 2.0 / divX;
        const yP = 2.0 / divY;
        for (let i = 0; i < divX + 1; i++) {
            const x = xP * i - 1;
            for (let j = 0; j < divY + 1; j++) {
                const y = 1 - yP * j;
                pos.push(x, y, 0);
                normal.push(0, 0, 1);
                uv.push(0, 0);
            }
        }
        for (let i = 0; i < divX; i++) {
            for (let j = 0; j < divY; j++) {
                const p0 = i * (divY + 1) + j + startIndex;
                const p1 = p0 + 1;
                const p3 = p0 + divY + 1;
                const p2 = p3 + 1;
                index.push(p0, p1, p3, p3, p1, p2);
            }
        }
    }
    static addQuad(pos, normal, uv, index, points) {
        const startIndex = pos.length / 3;
        const v0 = points[0], v1 = points[1], v3 = points[2];
        const v02v1 = v1.subtractWith(v0);
        const v02v3 = v3.subtractWith(v0);
        const v2 = v0.addWith(v02v1).addWith(v02v3);
        const nV = v02v1.crossWith(v02v3).normalizeThis();
        normal.push(nV.X, nV.Y, nV.Z, nV.X, nV.Y, nV.Z, nV.X, nV.Y, nV.Z, nV.X, nV.Y, nV.Z);
        uv.push(0, 1, 0, 0, 1, 0, 1, 1);
        pos.push(v0.X, v0.Y, v0.Z, v1.X, v1.Y, v1.Z, v2.X, v2.Y, v2.Z, v3.X, v3.Y, v3.Z);
        index.push(startIndex, startIndex + 1, startIndex + 3, startIndex + 3, startIndex + 1, startIndex + 2);
    }
    static addCircle(pos, normal, uv, index, divide, center, normalVector, tangentVector) {
        const tan2 = Vector3.cross(tangentVector, normalVector);
        const vecCount = 2 + divide;
        const baseIndex = uv.length / 2;
        for (let i = 0; i < vecCount; i++) {
            const v = GeometryBuilder._calcNextPointInCircle(i, divide, center, tangentVector, tan2);
            const u = GeometryBuilder._calcUVInCircle(i, divide);
            pos.push(v.X, v.Y, v.Z);
            normal.push(normalVector.X, normalVector.Y, normalVector.Z);
            uv.push(u[0], u[1]);
        }
        for (let i = 0; i < divide; i++) {
            index.push(baseIndex);
            index.push(baseIndex + i + 2);
            index.push(baseIndex + i + 1);
        }
    }
    static addCylinder(pos, normal, uv, index, divide, start, end, tangent, radius) {
        const dest = Vector3.subtract(end, start);
        let tangentNormalized = tangent.normalizeThis();
        let tan2 = Vector3.cross(dest.normalizeThis(), tangentNormalized);
        tangentNormalized = tangentNormalized.multiplyWith(radius);
        tan2 = tan2.multiplyWith(radius);
        for (let i = 0; i < divide; i++) {
            const angle = (i - 1) * 2 * Math.PI / divide;
            const angleTo = i * 2 * Math.PI / divide;
            const currentNormal = Vector3.add(tan2.multiplyWith(Math.cos(angle)), tangentNormalized.multiplyWith(Math.sin(angle)));
            const nextNormal = Vector3.add(tan2.multiplyWith(Math.cos(angleTo)), tangentNormalized.multiplyWith(Math.sin(angleTo)));
            const v0 = Vector3.add(start, currentNormal);
            const v1 = Vector3.add(start, nextNormal);
            const v2 = Vector3.add(v0, dest);
            const v3 = v1.addWith(dest);
            const startIndex = pos.length / 3;
            normal.push(currentNormal.X, currentNormal.Y, currentNormal.Z, nextNormal.X, nextNormal.Y, nextNormal.Z, nextNormal.X, nextNormal.Y, nextNormal.Z, currentNormal.X, currentNormal.Y, currentNormal.Z);
            uv.push(0, 1, 1, 0, 1, 0, 0, 0);
            pos.push(v0.X, v0.Y, v0.Z, v1.X, v1.Y, v1.Z, v3.X, v3.Y, v3.Z, v2.X, v2.Y, v2.Z);
            index.push(startIndex + 2, startIndex + 1, startIndex, startIndex + 3, startIndex + 2, startIndex);
        }
    }
    static addSphere(pos, normal, uv, index, divide1, divide2, center) {
        const vt = Vector3.add(center, new Vector3(0, 1, 0));
        const vb = Vector3.add(center, new Vector3(0, -1, 0));
        pos.push(vt.X, vt.Y, vt.Z);
        normal.push(0, 1, 0);
        uv.push(0, 1);
        for (let i = 0; i < divide1 - 1; i++) {
            const angle_y = (i + 1) * Math.PI / divide1;
            const d = Math.sin(angle_y);
            const h = Math.cos(angle_y);
            for (let j = 0; j < divide2; j++) {
                const angle_x = j * 2 * Math.PI / divide2;
                const v0 = new Vector3(d * Math.sin(angle_x), h, d * Math.cos(angle_x));
                const v0_n = v0.normalizeThis();
                const startIndex = pos.length / 3;
                pos.push(v0.X, v0.Y, v0.Z);
                normal.push(v0_n.X, v0_n.Y, v0_n.Z);
                uv.push(0, 1);
                if (i === 0) {
                    if (j !== 0) {
                        index.push(0, startIndex - 1, startIndex);
                        if (j === divide2 - 1) {
                            index.push(0, startIndex, 1);
                        }
                    }
                }
                else {
                    if (j === 0) {
                        index.push(startIndex - divide2, startIndex, startIndex - divide2 + 1);
                    }
                    else if (j === divide2 - 1) {
                        index.push(startIndex - divide2, startIndex - 1, startIndex);
                        index.push(startIndex - divide2 + 1, startIndex - divide2 - divide2 + 1, startIndex);
                        index.push(startIndex - divide2 - divide2 + 1, startIndex - divide2, startIndex);
                    }
                    else {
                        index.push(startIndex - divide2, startIndex - 1, startIndex);
                        index.push(startIndex - divide2 + 1, startIndex - divide2, startIndex);
                    }
                }
            }
        }
        const startIndex = pos.length / 3;
        pos.push(vb.X, vb.Y, vb.Z);
        normal.push(0, -1, 0);
        uv.push(0, 1);
        for (let j = 0; j < divide2 - 1; j++) {
            index.push(startIndex, startIndex - 1 - j, startIndex - 2 - j);
        }
        index.push(startIndex, startIndex - divide2, startIndex - 1);
    }
    static addCone(pos, normal, uv, index, divide) {
        pos.push(0, -1, 0);
        normal.push(0, -1, 0);
        uv.push(0, 1);
        const angle = 2 * Math.PI / divide;
        const y = Math.sqrt(5) / 5.0;
        const k = y * 2;
        let startIndex;
        for (let i = 0; i < divide; i++) {
            const d1 = Math.sin(angle * i);
            const d2 = Math.cos(angle * i);
            const v = new Vector3(d1, -1, d2);
            const vn = new Vector3(d1 * k, y, d2 * k);
            startIndex = pos.length / 3;
            pos.push(v.X, v.Y, v.Z, v.X, v.Y, v.Z, 0, 1, 0);
            uv.push(0, 1, 0, 1, 0, 1);
            normal.push(vn.X, vn.Y, vn.Z, 0, -1, 0, vn.X, vn.Y, vn.Z);
            if (i !== 0) {
                index.push(startIndex - 1, startIndex - 3, startIndex);
                index.push(0, startIndex + 1, startIndex - 2);
            }
        }
        startIndex = pos.length / 3 - 1;
        index.push(startIndex, startIndex - 2, 1);
        index.push(0, 2, startIndex - 1);
    }
    static _calcUVInCircle(index, divCount) {
        if (index === 0) {
            return [0, 0];
        }
        const angle = (index - 1) * 2 * Math.PI / divCount;
        return [Math.cos(angle), Math.sin(angle)];
    }
    static _calcNextPointInCircle(index, divCount, center, tan, tan2) {
        const angle = (index - 1) * 2 * Math.PI / divCount;
        return index === 0 ? center :
            Vector3.add(center, Vector3.add(tan.multiplyWith(Math.sin(angle)), tan2.multiplyWith(Math.cos(angle))));
    }
}
export default GeometryBuilder;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkNvcmUvR2VvbWV0cmllcy9CYXNlL0dlb21ldHJ5QnVpbGRlci50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiT0FBTyxPQUFPLE1BQU0sdUJBQXVCO0FBQzNDO0lBQ0UsT0FBYyxjQUFjLENBQUMsR0FBYSxFQUFFLE1BQWdCLEVBQUUsRUFBWSxFQUFFLEtBQWUsRUFBRSxJQUFZLEVBQUUsSUFBWTtRQUNySCxNQUFNLFVBQVUsR0FBRyxHQUFHLENBQUMsTUFBTSxHQUFHLENBQUMsQ0FBQztRQUNsQyxNQUFNLEVBQUUsR0FBRyxHQUFHLEdBQUcsSUFBSSxDQUFDO1FBQ3RCLE1BQU0sRUFBRSxHQUFHLEdBQUcsR0FBRyxJQUFJLENBQUM7UUFDdEIsR0FBRyxDQUFDLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsR0FBRyxJQUFJLEdBQUcsQ0FBQyxFQUFFLENBQUMsRUFBRSxFQUFFLENBQUM7WUFDbEMsTUFBTSxDQUFDLEdBQUcsRUFBRSxHQUFHLENBQUMsR0FBRyxDQUFDLENBQUM7WUFDckIsR0FBRyxDQUFDLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsR0FBRyxJQUFJLEdBQUcsQ0FBQyxFQUFFLENBQUMsRUFBRSxFQUFFLENBQUM7Z0JBQ2xDLE1BQU0sQ0FBQyxHQUFHLENBQUMsR0FBRyxFQUFFLEdBQUcsQ0FBQyxDQUFDO2dCQUNyQixHQUFHLENBQUMsSUFBSSxDQUFDLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUM7Z0JBQ2xCLE1BQU0sQ0FBQyxJQUFJLENBQUMsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQztnQkFDckIsRUFBRSxDQUFDLElBQUksQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUM7WUFDaEIsQ0FBQztRQUNILENBQUM7UUFDRCxHQUFHLENBQUMsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxHQUFHLElBQUksRUFBRSxDQUFDLEVBQUUsRUFBRSxD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QyxDQUFDO1FBQ25DLE1BQU0sS0FBSyxHQUFHLENBQUMsS0FBSyxHQUFHLENBQUMsQ0FBQyxHQUFHLENBQUMsR0FBRyxJQUFJLENBQUMsRUFBRSxHQUFHLFFBQVEsQ0FBQztRQUNuRCxNQUFNLENBQUMsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLEtBQUssQ0FBQyxFQUFFLElBQUksQ0FBQyxHQUFHLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQztJQUM1QyxDQUFDO0lBRUQsT0FBZSxzQkFBc0IsQ0FBQyxLQUFhLEVBQUUsUUFBZ0IsRUFBRSxNQUFlLEVBQUUsR0FBWSxFQUFFLElBQWE7UUFDakgsTUFBTSxLQUFLLEdBQUcsQ0FBQyxLQUFLLEdBQUcsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxHQUFHLElBQUksQ0FBQyxFQUFFLEdBQUcsUUFBUSxDQUFDO1FBQ25ELE1BQU0sQ0FBQyxLQUFLLEtBQUssQ0FBQyxHQUFHLE1BQU07WUFDekIsT0FBTyxDQUFDLEdBQUcsQ0FBQyxNQUFNLEVBQUUsT0FBTyxDQUFDLEdBQUcsQ0FBQyxHQUFHLENBQUMsWUFBWSxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsS0FBSyxDQUFDLENBQUMsRUFBRSxJQUFJLENBQUMsWUFBWSxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7SUFDNUcsQ0FBQztBQUNILENBQUM7QUFFRCxlQUFlLGVBQWUsQ0FBQyIsImZpbGUiOiJDb3JlL0dlb21ldHJpZXMvQmFzZS9HZW9tZXRyeUJ1aWxkZXIuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgVmVjdG9yMyBmcm9tIFwiLi4vLi4vLi4vTWF0aC9WZWN0b3IzXCI7XG5jbGFzcyBHZW9tZXRyeUJ1aWxkZXIge1xuICBwdWJsaWMgc3RhdGljIGFkZERpdmlkZWRRdWFkKHBvczogbnVtYmVyW10sIG5vcm1hbDogbnVtYmVyW10sIHV2OiBudW1iZXJbXSwgaW5kZXg6IG51bWJlcltdLCBkaXZYOiBudW1iZXIsIGRpdlk6IG51bWJlcik6IHZvaWQge1xuICAgIGNvbnN0IHN0YXJ0SW5kZXggPSBwb3MubGVuZ3RoIC8gMztcbiAgICBjb25zdCB4UCA9IDIuMCAvIGRpdlg7XG4gICAgY29uc3QgeVAgPSAyLjAgLyBkaXZZO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZGl2WCArIDE7IGkrKykge1xuICAgICAgY29uc3QgeCA9IHhQICogaSAtIDE7XG4gICAgICBmb3IgKGxldCBqID0gMDsgaiA8IGRpdlkgKyAxOyBqKyspIHtcbiAgICAgICAgY29uc3QgeSA9IDEgLSB5UCAqIGo7XG4gICAgICAgIHBvcy5wdXNoKHgsIHksIDApO1xuICAgICAgICBub3JtYWwucHVzaCgwLCAwLCAxKTtcbiAgICAgICAgdXYucHVzaCgwLCAwKTtcbiAgICAgIH1cbiAgICB9XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBkaXZYOyBpKyspIHtcbiAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgZGl2WTsgaisrKSB7XG4gICAgICAgIGNvbnN0IHAwID0gaSAqIChkaXZZICsgMSkgKyBqICsgc3RhcnRJbmRleDtcbiAgICAgICAgY29uc3QgcDEgPSBwMCArIDE7XG4gICAgICAgIGNvbnN0IHAzID0gcDAgKyBkaXZZICsgMTtcbiAgICAgICAgY29uc3QgcDIgPSBwMyArIDE7XG4gICAgICAgIGluZGV4LnB1c2gocDAsIHAxLCBwMywgcDMsIHAxLCBwMik7XG4gICAgICB9XG4gICAgfVxuICB9XG4gIHB1YmxpYyBzdGF0aWMgYWRkUXVhZChwb3M6IG51bWJlcltdLCBub3JtYWw6IG51bWJlcltdLCB1djogbnVtYmVyW10sIGluZGV4OiBudW1iZXJbXSwgcG9pbnRzOiBWZWN0b3IzW10pOiB2b2lkIHtcbiAgICBjb25zdCBzdGFydEluZGV4ID0gcG9zLmxlbmd0aCAvIDM7XG4gICAgY29uc3QgdjAgPSBwb2ludHNbMF0sIHYxID0gcG9pbnRzWzFdLCB2MyA9IHBvaW50c1syXTtcbiAgICBjb25zdCB2MDJ2MSA9IHYxLnN1YnRyYWN0V2l0aCh2MCk7XG4gICAgY29uc3QgdjAydjMgPSB2My5zdWJ0cmFjdFdpdGgodjApO1xuICAgIGNvbnN0IHYyID0gdjAuYWRkV2l0aCh2MDJ2MSkuYWRkV2l0aCh2MDJ2Myk7XG4gICAgY29uc3QgblYgPSB2MDJ2MS5jcm9zc1dpdGgodjAydjMpLm5vcm1hbGl6ZVRoaXMoKTtcbiAgICBub3JtYWwucHVzaChuVi5YLCBuVi5ZLCBuVi5aLCBuVi5YLCBuVi5ZLCBuVi5aLCBuVi5YLCBuVi5ZLCBuVi5aLCBuVi5YLCBuVi5ZLCBuVi5aKTtcbiAgICB1di5wdXNoKDAsIDEsIDAsIDAsIDEsIDAsIDEsIDEpO1xuICAgIHBvcy5wdXNoKHYwLlgsIHYwLlksIHYwLlosIHYxLlgsIHYxLlksIHYxLlosIHYyLlgsIHYyLlksIHYyLlosIHYzLlgsIHYzLlksIHYzLlopO1xuICAgIGluZGV4LnB1c2goc3RhcnRJbmRleCwgc3RhcnRJbmRleCArIDEsIHN0YXJ0SW5kZXggKyAzLCBzdGFydEluZGV4ICsgMywgc3RhcnRJbmRleCArIDEsIHN0YXJ0SW5kZXggKyAyKTtcbiAgfVxuXG4gIHB1YmxpYyBzdGF0aWMgYWRkQ2lyY2xlKHBvczogbnVtYmVyW10sIG5vcm1hbDogbnVtYmVyW10sIHV2OiBudW1iZXJbXSwgaW5kZXg6IG51bWJlcltdLCBkaXZpZGU6IG51bWJlciwgY2VudGVyOiBWZWN0b3IzLCBub3JtYWxWZWN0b3I6IFZlY3RvcjMsIHRhbmdlbnRWZWN0b3I6IFZlY3RvcjMpOiB2b2lkIHtcbiAgICBjb25zdCB0YW4yID0gVmVjdG9yMy5jcm9zcyh0YW5nZW50VmVjdG9yLCBub3JtYWxWZWN0b3IpO1xuICAgIGNvbnN0IHZlY0NvdW50ID0gMiArIGRpdmlkZTtcbiAgICBjb25zdCBiYXNlSW5kZXggPSB1di5sZW5ndGggLyAyO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdmVjQ291bnQ7IGkrKykge1xuICAgICAgY29uc3QgdjogVmVjdG9yMyA9IEdlb21ldHJ5QnVpbGRlci5fY2FsY05leHRQb2ludEluQ2lyY2xlKGksIGRpdmlkZSwgY2VudGVyLCB0YW5nZW50VmVjdG9yLCB0YW4yKTtcbiAgICAgIGNvbnN0IHUgPSBHZW9tZXRyeUJ1aWxkZXIuX2NhbGNVVkluQ2lyY2xlKGksIGRpdmlkZSk7XG4gICAgICBwb3MucHVzaCh2LlgsIHYuWSwgdi5aKTtcbiAgICAgIG5vcm1hbC5wdXNoKG5vcm1hbFZlY3Rvci5YLCBub3JtYWxWZWN0b3IuWSwgbm9ybWFsVmVjdG9yLlopO1xuICAgICAgdXYucHVzaCh1WzBdLCB1WzFdKTtcbiAgICB9XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBkaXZpZGU7IGkrKykge1xuICAgICAgaW5kZXgucHVzaChiYXNlSW5kZXgpO1xuICAgICAgaW5kZXgucHVzaChiYXNlSW5kZXggKyBpICsgMik7XG4gICAgICBpbmRleC5wdXNoKGJhc2VJbmRleCArIGkgKyAxKTtcbiAgICB9XG4gIH1cblxuICBwdWJsaWMgc3RhdGljIGFkZEN5bGluZGVyKHBvczogbnVtYmVyW10sIG5vcm1hbDogbnVtYmVyW10sIHV2OiBudW1iZXJbXSwgaW5kZXg6IG51bWJlcltdLCBkaXZpZGU6IG51bWJlciwgc3RhcnQ6IFZlY3RvcjMsIGVuZDogVmVjdG9yMywgdGFuZ2VudDogVmVjdG9yMywgcmFkaXVzOiBudW1iZXIpOiB2b2lkIHtcbiAgICBjb25zdCBkZXN0OiBWZWN0b3IzID0gVmVjdG9yMy5zdWJ0cmFjdChlbmQsIHN0YXJ0KTtcbiAgICBsZXQgdGFuZ2VudE5vcm1hbGl6ZWQ6IFZlY3RvcjMgPSB0YW5nZW50Lm5vcm1hbGl6ZVRoaXMoKTtcbiAgICBsZXQgdGFuMjogVmVjdG9yMyA9IFZlY3RvcjMuY3Jvc3MoZGVzdC5ub3JtYWxpemVUaGlzKCksIHRhbmdlbnROb3JtYWxpemVkKTtcbiAgICB0YW5nZW50Tm9ybWFsaXplZCA9IHRhbmdlbnROb3JtYWxpemVkLm11bHRpcGx5V2l0aChyYWRpdXMpO1xuICAgIHRhbjIgPSB0YW4yLm11bHRpcGx5V2l0aChyYWRpdXMpO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZGl2aWRlOyBpKyspIHtcbiAgICAgIGNvbnN0IGFuZ2xlID0gKGkgLSAxKSAqIDIgKiBNYXRoLlBJIC8gZGl2aWRlO1xuICAgICAgY29uc3QgYW5nbGVUbyA9IGkgKiAyICogTWF0aC5QSSAvIGRpdmlkZTtcbiAgICAgIGNvbnN0IGN1cnJlbnROb3JtYWwgPSBWZWN0b3IzLmFkZCh0YW4yLm11bHRpcGx5V2l0aChNYXRoLmNvcyhhbmdsZSkpLCB0YW5nZW50Tm9ybWFsaXplZC5tdWx0aXBseVdpdGgoTWF0aC5zaW4oYW5nbGUpKSk7XG4gICAgICBjb25zdCBuZXh0Tm9ybWFsID0gVmVjdG9yMy5hZGQodGFuMi5tdWx0aXBseVdpdGgoTWF0aC5jb3MoYW5nbGVUbykpLCB0YW5nZW50Tm9ybWFsaXplZC5tdWx0aXBseVdpdGgoTWF0aC5zaW4oYW5nbGVUbykpKTtcbiAgICAgIGNvbnN0IHYwID0gVmVjdG9yMy5hZGQoc3RhcnQsIGN1cnJlbnROb3JtYWwpO1xuICAgICAgY29uc3QgdjEgPSBWZWN0b3IzLmFkZChzdGFydCwgbmV4dE5vcm1hbCk7XG4gICAgICBjb25zdCB2MiA9IFZlY3RvcjMuYWRkKHYwLCBkZXN0KTtcbiAgICAgIGNvbnN0IHYzID0gdjEuYWRkV2l0aChkZXN0KTtcbiAgICAgIGNvbnN0IHN0YXJ0SW5kZXggPSBwb3MubGVuZ3RoIC8gMztcbiAgICAgIG5vcm1hbC5wdXNoKGN1cnJlbnROb3JtYWwuWCwgY3VycmVudE5vcm1hbC5ZLCBjdXJyZW50Tm9ybWFsLlosXG4gICAgICAgIG5leHROb3JtYWwuWCwgbmV4dE5vcm1hbC5ZLCBuZXh0Tm9ybWFsLlosXG4gICAgICAgIG5leHROb3JtYWwuWCwgbmV4dE5vcm1hbC5ZLCBuZXh0Tm9ybWFsLlosXG4gICAgICAgIGN1cnJlbnROb3JtYWwuWCwgY3VycmVudE5vcm1hbC5ZLCBjdXJyZW50Tm9ybWFsLlopO1xuICAgICAgdXYucHVzaCgwLCAxLCAxLCAwLCAxLCAwLCAwLCAwKTtcbiAgICAgIHBvcy5wdXNoKHYwLlgsIHYwLlksIHYwLlosIHYxLlgsIHYxLlksIHYxLlosIHYzLlgsIHYzLlksIHYzLlosIHYyLlgsIHYyLlksIHYyLlopO1xuICAgICAgaW5kZXgucHVzaChzdGFydEluZGV4ICsgMiwgc3RhcnRJbmRleCArIDEsIHN0YXJ0SW5kZXgsIHN0YXJ0SW5kZXggKyAzLCBzdGFydEluZGV4ICsgMiwgc3RhcnRJbmRleCk7XG4gICAgfVxuICB9XG4gIHB1YmxpYyBzdGF0aWMgYWRkU3BoZXJlKHBvczogbnVtYmVyW10sIG5vcm1hbDogbnVtYmVyW10sIHV2OiBudW1iZXJbXSwgaW5kZXg6IG51bWJlcltdLCBkaXZpZGUxOiBudW1iZXIsIGRpdmlkZTI6IG51bWJlciwgY2VudGVyOiBWZWN0b3IzKTogdm9pZCB7XG4gICAgY29uc3QgdnQgPSBWZWN0b3IzLmFkZChjZW50ZXIsIG5ldyBWZWN0b3IzKDAsIDEsIDApKTtcbiAgICBjb25zdCB2YiA9IFZlY3RvcjMuYWRkKGNlbnRlciwgbmV3IFZlY3RvcjMoMCwgLTEsIDApKTtcbiAgICBwb3MucHVzaCh2dC5YLCB2dC5ZLCB2dC5aKTtcbiAgICBub3JtYWwucHVzaCgwLCAxLCAwKTtcbiAgICB1di5wdXNoKDAsIDEpO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZGl2aWRlMSAtIDE7IGkrKykge1xuICAgICAgY29uc3QgYW5nbGVfeSA9IChpICsgMSkgKiBNYXRoLlBJIC8gZGl2aWRlMTtcbiAgICAgIGNvbnN0IGQgPSBNYXRoLnNpbihhbmdsZV95KTtcbiAgICAgIGNvbnN0IGggPSBNYXRoLmNvcyhhbmdsZV95KTtcbiAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgZGl2aWRlMjsgaisrKSB7XG4gICAgICAgIGNvbnN0IGFuZ2xlX3ggPSBqICogMiAqIE1hdGguUEkgLyBkaXZpZGUyO1xuICAgICAgICBjb25zdCB2MCA9IG5ldyBWZWN0b3IzKGQgKiBNYXRoLnNpbihhbmdsZV94KSwgaCwgZCAqIE1hdGguY29zKGFuZ2xlX3gpKTtcbiAgICAgICAgY29uc3QgdjBfbiA9IHYwLm5vcm1hbGl6ZVRoaXMoKTtcbiAgICAgICAgY29uc3Qgc3RhcnRJbmRleCA9IHBvcy5sZW5ndGggLyAzO1xuXG4gICAgICAgIHBvcy5wdXNoKHYwLlgsIHYwLlksIHYwLlopO1xuICAgICAgICBub3JtYWwucHVzaCh2MF9uLlgsIHYwX24uWSwgdjBfbi5aKTtcbiAgICAgICAgdXYucHVzaCgwLCAxKTtcblxuICAgICAgICBpZiAoaSA9PT0gMCkge1xuICAgICAgICAgIGlmIChqICE9PSAwKSB7XG4gICAgICAgICAgICBpbmRleC5wdXNoKDAsIHN0YXJ0SW5kZXggLSAxLCBzdGFydEluZGV4KTtcbiAgICAgICAgICAgIGlmIChqID09PSBkaXZpZGUyIC0gMSkge1xuICAgICAgICAgICAgICBpbmRleC5wdXNoKDAsIHN0YXJ0SW5kZXgsIDEpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBpZiAoaiA9PT0gMCkge1xuICAgICAgICAgICAgaW5kZXgucHVzaChzdGFydEluZGV4IC0gZGl2aWRlMiwgc3RhcnRJbmRleCwgc3RhcnRJbmRleCAtIGRpdmlkZTIgKyAxKTtcbiAgICAgICAgICB9IGVsc2UgaWYgKGogPT09IGRpdmlkZTIgLSAxKSB7XG4gICAgICAgICAgICBpbmRleC5wdXNoKHN0YXJ0SW5kZXggLSBkaXZpZGUyLCBzdGFydEluZGV4IC0gMSwgc3RhcnRJbmRleCk7XG4gICAgICAgICAgICBpbmRleC5wdXNoKHN0YXJ0SW5kZXggLSBkaXZpZGUyICsgMSwgc3RhcnRJbmRleCAtIGRpdmlkZTIgLSBkaXZpZGUyICsgMSwgc3RhcnRJbmRleCk7XG4gICAgICAgICAgICBpbmRleC5wdXNoKHN0YXJ0SW5kZXggLSBkaXZpZGUyIC0gZGl2aWRlMiArIDEsIHN0YXJ0SW5kZXggLSBkaXZpZGUyLCBzdGFydEluZGV4KTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgaW5kZXgucHVzaChzdGFydEluZGV4IC0gZGl2aWRlMiwgc3RhcnRJbmRleCAtIDEsIHN0YXJ0SW5kZXgpO1xuICAgICAgICAgICAgaW5kZXgucHVzaChzdGFydEluZGV4IC0gZGl2aWRlMiArIDEsIHN0YXJ0SW5kZXggLSBkaXZpZGUyLCBzdGFydEluZGV4KTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICBjb25zdCBzdGFydEluZGV4ID0gcG9zLmxlbmd0aCAvIDM7XG4gICAgcG9zLnB1c2godmIuWCwgdmIuWSwgdmIuWik7XG4gICAgbm9ybWFsLnB1c2goMCwgLTEsIDApO1xuICAgIHV2LnB1c2goMCwgMSk7XG4gICAgZm9yIChsZXQgaiA9IDA7IGogPCBkaXZpZGUyIC0gMTsgaisrKSB7XG4gICAgICBpbmRleC5wdXNoKHN0YXJ0SW5kZXgsIHN0YXJ0SW5kZXggLSAxIC0gaiwgc3RhcnRJbmRleCAtIDIgLSBqKTtcbiAgICB9XG4gICAgaW5kZXgucHVzaChzdGFydEluZGV4LCBzdGFydEluZGV4IC0gZGl2aWRlMiwgc3RhcnRJbmRleCAtIDEpO1xuICB9XG4gIHB1YmxpYyBzdGF0aWMgYWRkQ29uZShwb3M6IG51bWJlcltdLCBub3JtYWw6IG51bWJlcltdLCB1djogbnVtYmVyW10sIGluZGV4OiBudW1iZXJbXSwgZGl2aWRlOiBudW1iZXIpOiB2b2lkIHtcbiAgICBwb3MucHVzaCgwLCAtMSwgMCk7XG4gICAgbm9ybWFsLnB1c2goMCwgLTEsIDApO1xuICAgIHV2LnB1c2goMCwgMSk7XG4gICAgY29uc3QgYW5nbGUgPSAyICogTWF0aC5QSSAvIGRpdmlkZTtcbiAgICBjb25zdCB5ID0gTWF0aC5zcXJ0KDUpIC8gNS4wO1xuICAgIGNvbnN0IGsgPSB5ICogMjtcbiAgICBsZXQgc3RhcnRJbmRleDtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGRpdmlkZTsgaSsrKSB7XG4gICAgICBjb25zdCBkMSA9IE1hdGguc2luKGFuZ2xlICogaSk7XG4gICAgICBjb25zdCBkMiA9IE1hdGguY29zKGFuZ2xlICogaSk7XG5cbiAgICAgIGNvbnN0IHYgPSBuZXcgVmVjdG9yMyhkMSwgLTEsIGQyKTtcbiAgICAgIGNvbnN0IHZuID0gbmV3IFZlY3RvcjMoZDEgKiBrLCB5LCBkMiAqIGspO1xuXG4gICAgICBzdGFydEluZGV4ID0gcG9zLmxlbmd0aCAvIDM7XG4gICAgICBwb3MucHVzaCh2LlgsIHYuWSwgdi5aLCB2LlgsIHYuWSwgdi5aLCAwLCAxLCAwKTtcbiAgICAgIHV2LnB1c2goMCwgMSwgMCwgMSwgMCwgMSk7XG4gICAgICBub3JtYWwucHVzaCh2bi5YLCB2bi5ZLCB2bi5aLCAwLCAtMSwgMCwgdm4uWCwgdm4uWSwgdm4uWik7XG5cbiAgICAgIGlmIChpICE9PSAwKSB7XG4gICAgICAgIGluZGV4LnB1c2goc3RhcnRJbmRleCAtIDEsIHN0YXJ0SW5kZXggLSAzLCBzdGFydEluZGV4KTtcbiAgICAgICAgaW5kZXgucHVzaCgwLCBzdGFydEluZGV4ICsgMSwgc3RhcnRJbmRleCAtIDIpO1xuICAgICAgfVxuICAgIH1cbiAgICBzdGFydEluZGV4ID0gcG9zLmxlbmd0aCAvIDMgLSAxO1xuICAgIGluZGV4LnB1c2goc3RhcnRJbmRleCwgc3RhcnRJbmRleCAtIDIsIDEpO1xuICAgIGluZGV4LnB1c2goMCwgMiwgc3RhcnRJbmRleCAtIDEpO1xuICB9XG5cbiAgcHJpdmF0ZSBzdGF0aWMgX2NhbGNVVkluQ2lyY2xlKGluZGV4OiBudW1iZXIsIGRpdkNvdW50OiBudW1iZXIpOiBudW1iZXJbXSB7XG4gICAgaWYgKGluZGV4ID09PSAwKSB7IHJldHVybiBbMCwgMF07IH1cbiAgICBjb25zdCBhbmdsZSA9IChpbmRleCAtIDEpICogMiAqIE1hdGguUEkgLyBkaXZDb3VudDtcbiAgICByZXR1cm4gW01hdGguY29zKGFuZ2xlKSwgTWF0aC5zaW4oYW5nbGUpXTtcbiAgfVxuXG4gIHByaXZhdGUgc3RhdGljIF9jYWxjTmV4dFBvaW50SW5DaXJjbGUoaW5kZXg6IG51bWJlciwgZGl2Q291bnQ6IG51bWJlciwgY2VudGVyOiBWZWN0b3IzLCB0YW46IFZlY3RvcjMsIHRhbjI6IFZlY3RvcjMpOiBWZWN0b3IzIHtcbiAgICBjb25zdCBhbmdsZSA9IChpbmRleCAtIDEpICogMiAqIE1hdGguUEkgLyBkaXZDb3VudDtcbiAgICByZXR1cm4gaW5kZXggPT09IDAgPyBjZW50ZXIgOlxuICAgICAgVmVjdG9yMy5hZGQoY2VudGVyLCBWZWN0b3IzLmFkZCh0YW4ubXVsdGlwbHlXaXRoKE1hdGguc2luKGFuZ2xlKSksIHRhbjIubXVsdGlwbHlXaXRoKE1hdGguY29zKGFuZ2xlKSkpKTtcbiAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBHZW9tZXRyeUJ1aWxkZXI7XG4iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=

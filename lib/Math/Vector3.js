import VectorBase from "./VectorBase";
import { vec3 } from "gl-matrix";
class Vector3 extends VectorBase {
    constructor(x, y, z) {
        super();
        if (typeof y === "undefined") {
            this.rawElements = x;
            return;
        }
        this.rawElements = [x, y, z];
    }
    static get XUnit() {
        return new Vector3(1, 0, 0);
    }
    static get YUnit() {
        return new Vector3(0, 1, 0);
    }
    static get ZUnit() {
        return new Vector3(0, 0, 1);
    }
    static get Zero() {
        return new Vector3(0, 0, 0);
    }
    static get One() {
        return new Vector3(1, 1, 1);
    }
    static copy(source) {
        return new Vector3(source.X, source.Y, source.Z);
    }
    static dot(v1, v2) {
        return vec3.dot(v1.rawElements, v2.rawElements);
    }
    static add(v1, v2) {
        const newVec = vec3.create();
        return new Vector3(vec3.add(newVec, v1.rawElements, v2.rawElements));
    }
    static subtract(v1, v2) {
        const newVec = vec3.create();
        return new Vector3(vec3.sub(newVec, v1.rawElements, v2.rawElements));
    }
    static multiply(s, v) {
        const newVec = vec3.create();
        return new Vector3(vec3.scale(newVec, v.rawElements, s));
    }
    static negate(v1) {
        return Vector3.multiply(-1, v1);
    }
    static equals(v1, v2) {
        return VectorBase.__elementEquals(v1, v2);
    }
    static nearlyEquals(v1, v2) {
        return VectorBase.__nearlyElementEquals(v1, v2);
    }
    static normalize(v1) {
        const newVec = vec3.create();
        return new Vector3(vec3.normalize(newVec, v1.rawElements));
    }
    static cross(v1, v2) {
        const newVec = vec3.create();
        return new Vector3(vec3.cross(newVec, v1.rawElements, v2.rawElements));
    }
    static min(v1, v2) {
        return new Vector3(VectorBase.__fromGenerationFunction(v1, v2, (i, _v1, _v2) => Math.min(_v1.rawElements[i], _v2.rawElements[i])));
    }
    static max(v1, v2) {
        return new Vector3(VectorBase.__fromGenerationFunction(v1, v2, (i, _v1, _v2) => Math.max(_v1.rawElements[i], _v2.rawElements[i])));
    }
    static angle(v1, v2) {
        return Math.acos(Vector3.dot(v1.normalized, v2.normalized));
    }
    static parse(str) {
        const parseResult = VectorBase.__parse(str);
        const elements = parseResult.elements;
        if (!elements || (elements.length !== 1 && elements.length !== 3)) {
            return undefined;
        }
        let result;
        if (elements.length === 1) {
            result = new Vector3(elements[0], elements[0], elements[0]);
        }
        else {
            result = new Vector3(elements[0], elements[1], elements[2]);
        }
        if (parseResult.needNormalize) {
            result = result.normalizeThis();
        }
        if (parseResult.coefficient) {
            result = result.multiplyWith(parseResult.coefficient);
        }
        if (parseResult.needNegate) {
            result = result.negateThis();
        }
        return result;
    }
    toMathematicaString() {
        return `{${this.X},${this.Y},${this.Z}}`;
    }
    get normalized() {
        return this.multiplyWith(1 / this.magnitude);
    }
    get X() {
        return this.rawElements[0];
    }
    get Y() {
        return this.rawElements[1];
    }
    get Z() {
        return this.rawElements[2];
    }
    set X(x) {
        this.rawElements[0] = +x;
    }
    set Y(y) {
        this.rawElements[1] = +y;
    }
    set Z(z) {
        this.rawElements[2] = +z;
    }
    normalizeThis() {
        return Vector3.normalize(this);
    }
    dotWith(v) {
        return Vector3.dot(this, v);
    }
    addWith(v) {
        return Vector3.add(this, v);
    }
    subtractWith(v) {
        return Vector3.subtract(this, v);
    }
    multiplyWith(s) {
        return Vector3.multiply(s, this);
    }
    negateThis() {
        return Vector3.negate(this);
    }
    equalWith(v) {
        return Vector3.equals(this, v);
    }
    nearlyEqualWith(v) {
        return Vector3.nearlyEquals(this, v);
    }
    crossWith(v) {
        return Vector3.cross(this, v);
    }
    toString() {
        return `(${this.X}, ${this.Y}, ${this.Z})`;
    }
    toDisplayString() {
        return `Vector3${this.toString()}`;
    }
    get ElementCount() { return 3; }
}
export default Vector3;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIk1hdGgvVmVjdG9yMy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiT0FBTyxVQUFVLE1BQU0sY0FBYztPQUM5QixFQUFNLElBQUksRUFBQyxNQUFNLFdBQVc7QUFFbkMsc0JBQXNCLFVBQVU7SUFJOUIsWUFBWSxDQUFzQixFQUFFLENBQVUsRUFBRSxDQUFVO1FBQ3hELE9BQU8sQ0FBQztRQUNSLEVBQUUsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxLQUFLLFdBQVcsQ0FBQyxDQUFDLENBQUM7WUFDN0IsSUFBSSxDQUFDLFdBQVcsR0FBZSxDQUFDLENBQUM7WUFDakMsTUFBTSxDQUFDO1FBQ1QsQ0FBQztRQUNELElBQUksQ0FBQyxXQUFXLEdBQUcsQ0FBUyxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDO0lBQ3ZDLENBQUM7SUFFRCxXQUFrQixLQUFLO1FBQ3JCLE1BQU0sQ0FBQyxJQUFJLE9BQU8sQ0FBQyxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDO0lBQzlCLENBQUM7SUFFRCxXQUFrQixLQUFLO1FBQ3JCLE1BQU0sQ0FBQyxJQUFJLE9BQU8sQ0FBQyxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDO0lBQzlCLENBQUM7SUFFRCxXQUFrQixLQUFLO1FBQ3JCLE1BQU0sQ0FBQyxJQUFJLE9BQU8sQ0FBQyxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDO0lBQzlCLENBQUM7SUFFRCxXQUFrQixJQUFJO1FBQ3BCLE1BQU0sQ0FBQyxJQUFJLE9BQU8sQ0FBQyxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDO0lBQzlCLENBQUM7SUFFRCxXQUFrQixHQUFHO1FBQ25CLE1BQU0sQ0FBQyxJQUFJLE9BQU8sQ0FBQyxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDO0lBQzlCLENBQUM7SUFFRCxPQUFjLElBQUksQ0FBQyxNQUFlO1FBQ2hDLE1BQU0sQ0FBQyxJQUFJLE9BQU8sQ0FBQyxNQUFNLENBQUMsQ0FBQyxFQUFFLE1BQU0sQ0FBQyxDQUFDLEVBQUUsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDO0lBQ25ELENBQUM7SUFFRCxPQUFjLEdBQUcsQ0FBQyxFQUFXLEVBQUUsRUFBVztRQUN4QyxNQUFNLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsV0FBVyxFQUFFLEVBQUUsQ0FBQyxXQUFXLENBQUMsQ0FBQztJQUNsRCxDQUFDO0lBRUQsT0FBYyxHQUFHLENBQUMsRUFBVyxFQUFFLEVBQVc7UUFDeEMsTUFBTSxNQUFNLEdBQUcsSUFBSSxDQUFDLE1BQU0sRUFBRSxDQUFDO1FBQzdCLE1BQU0sQ0FBQyxJQUFJLE9BQU8sQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLE1BQU0sRUFBRSxFQUFFLENBQUMsV0FBVyxFQUFFLEVBQUUsQ0FBQyxXQUFXLENBQUMsQ0FBQyxDQUFDO0lBQ3ZFLENBQUM7SUFFRCxPQUFjLFFBQVEsQ0FBQyxFQUFXLEVBQUUsRUFBVztRQUM3QyxNQUFNLE1BQU0sR0FBRyxJQUFJLENBQUMsTUFBTSxFQUFFLENBQUM7UUFDN0IsTUFBTSxDQUFDLElBQUksT0FBTyxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsTUFBTSxFQUFFLEVBQUUsQ0FBQyxXQUFXLEVBQUUsRUFBRSxDQUFDLFdBQVcsQ0FBQyxDQUFDLENBQUM7SUFDdkUsQ0FBQztJQUVELE9BQWMsUUFBUSxDQUFDLENBQVMsRUFBRSxDQUFVO1FBQzFDLE1BQU0sTUFBTSxHQUFHLElBQUksQ0FBQyxNQUFNLEVBQUUsQ0FBQztRQUM3QixNQUFNLENBQUMsSUFBSSxPQUFPLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxNQUFNLEVBQUUsQ0FBQyxDQUFDLFdBQVcsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDO0lBQzNELENBQUM7SUFFRCxPQUFjLE1BQU0sQ0FBQyxFQUFXO1FBQzlCLE1BQU0sQ0FBQyxPQUFPLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQyxFQUFFLEVBQUUsQ0FBQyxDQUFDO0lBQ2xDLENBQUM7SUFFRCxPQUFjLE1BQU0sQ0FBQyxFQUFXLEVBQUUsRUFBVztRQUMzQyxNQUFNLENBQUMsVUFBVSxDQUFDLGVBQWUsQ0FBQyxFQUFFLEVBQUUsRUFBRSxDQUFDLENBQUM7SUFDNUMsQ0FBQztJQUVELE9BQWMsWUFBWSxDQUFDLEVBQVcsRUFBRSxFQUFXO1FBQ2pELE1BQU0sQ0FBQyxVQUFVLENBQUMscUJBQXFCLENBQUMsRUFBRSxFQUFFLEVBQUUsQ0FBQyxDQUFDO0lBQ2xELENBQUM7SUFFRCxPQUFjLFNBQVMsQ0FBQyxFQUFXO1FBQ2pDLE1BQU0sTUFBTSxHQUFHLElBQUksQ0FBQyxNQUFNLEVBQUUsQ0FBQztRQUM3QixNQUFNLENBQUMsSUFBSSxPQUFPLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxNQUFNLEVBQUUsRUFBRSxDQUFDLFdBQVcsQ0FBQyxDQUFDLENBQUM7SUFDN0QsQ0FBQztJQUVELE9BQWMsS0FBSyxDQUFDLEVBQVcsRUFBRSxFQUFXO1FBQzFDLE1BQU0sTUFBTSxHQUFHLElBQUksQ0FBQyxNQUFNLEVBQUUsQ0FBQztRQUM3QixNQUFNLENBQUMsSUFBSSxPQUFPLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxNQUFNLEVBQUUsRUFBRSxDQUFDLFdBQVcsRUFBRSxFQUFFLENBQUMsV0FBVyxDQUFDLENBQUMsQ0FBQztJQUN6RSxDQUFDO0lBR0QsT0FBYyxHQUFHLENBQUMsRUFBVyxFQUFFLEVBQVc7UUFDeEMsTUFBTSxDQUFDLElBQUksT0FBTyxDQUFDLFVBQVUsQ0FBQyx3QkFBd0IsQ0FBQyxFQUFFLEVBQUUsRUFBRSxFQUFFLENBQUMsQ0FBQyxFQUFFLEdBQUcsRUFBRSxHQUFHLEtBQUssSUFBSSxDQUFDLEdBQUcsQ0FBQyxHQUFHLENBQUMsV0FBVyxDQUFDLENBQUMsQ0FBQyxFQUFFLEdBQUcsQ0FBQyxXQUFXLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7SUFDckksQ0FBQztJQUNELE9BQWMsR0FBRyxDQUFDLEVBQVcsRUFBRSxFQUFXO1FBQ3hDLE1BQU0sQ0FBQyxJQUFJLE9BQU8sQ0FBQyxVQUFVLENBQUMsd0JBQXdCLENBQUMsRUFBRSxFQUFFLEVBQUUsRUFBRSxDQUFDLENBQUMsRUFBRSxHQUFHLEVBQUUsR0FBRyxLQUFLLElBQUksQ0FBQyxHQUFHLENBQUMsR0FBRyxDQUFDLFdBQVcsQ0FBQyxDQUFDLENBQUMsRUFBRSxHQUFHLENBQUMsV0FBVyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO0lBQ3JJLENBQUM7SUFFRCxPQUFjLEtBQUssQ0FBQyxFQUFXLEVBQUUsRUFBVztRQUMxQyxNQUFNLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxVQUFVLEVBQUUsRUFBRSxDQUFDLFVBQVUsQ0FBQyxDQUFDLENBQUM7SUFDOUQsQ0FBQztJQUVELE9BQWMsS0FBSyxDQUFDLEdBQVc7UUFDN0IsTUFBTSxXQUFXLEdBQUcsVUFBVSxDQUFDLE9BQU8sQ0FBQyxHQUFHLENBQUMsQ0FBQztRQUM1QyxNQUFNLFFBQVEsR0FBRyxXQUFXLENBQUMsUUFBUSxDQUFDO1FBRXRDLEVBQUUsQ0FBQyxDQUFDLENBQUMsUUFBUSxJQUFJLENBQUMsUUFBUSxDQUFDLE1BQU0sS0FBSyxDQUFDLElBQUksUUFBUSxDQUFDLE1BQU0sS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFDbEUsTUFBTSxDQUFDLFNBQVMsQ0FBQztRQUNuQixDQUFDO1FBQ0QsSUFBSSxNQUFNLENBQUM7UUFDWCxFQUFFLENBQUMsQ0FBQyxRQUFRLENBQUMsTUFBTSxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFDMUIsTUFBTSxHQUFHLElBQUksT0FBTyxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsRUFBRSxRQUFRLENBQUMsQ0FBQyxDQUFDLEVBQUUsUUFBUSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDOUQsQ0FBQztRQUFDLElBQUksQ0FBQyxDQUFDO1lBQ04sTUFBTSxHQUFHLElBQUksT0FBTyxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsRUFBRSxRQUFRLENBQUMsQ0FBQyxDQUFDLEVBQUUsUUFBUSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDOUQsQ0FBQztRQUNELEVBQUUsQ0FBQyxDQUFDLFdBQVcsQ0FBQyxhQUFhLENBQUMsQ0FBQyxDQUFDO1lBQzlCLE1BQU0sR0FBRyxNQUFNLENBQUMsYUFBYSxFQUFFLENBQUM7UUFDbEMsQ0FBQztRQUNELEVBQUUsQ0FBQyxDQUFDLFdBQVcsQ0FBQyxXQUFXLENBQUMsQ0FBQyxDQUFDO1lBQzVCLE1BQU0sR0FBRyxNQUFNLENBQUMsWUFBWSxDQUFDLFdBQVcsQ0FBQyxXQUFXLENBQUMsQ0FBQztRQUN4RCxDQUFDO1FBQ0QsRUFBRSxDQUFDLENBQUMsV0FBVyxDQUFDLFVBQVUsQ0FBQyxDQUFDLENBQUM7WUFDM0IsTUFBTSxHQUFHLE1BQU0sQ0FBQyxVQUFVLEVBQUUsQ0FBQztRQUMvQixDQUFDO1FBQ0QsTUFBTSxDQUFDLE1BQU0sQ0FBQztJQUNoQixDQUFDO0lBRU0sbUJBQW1CO1FBQ3hCLE1BQU0sQ0FBQyxJQUFJLElBQUksQ0FBQyxDQUFDLElBQUksSUFBSSxDQUFDLENBQUMsSUFBSSxJQUFJLENBQUMsQ0FBQyxHQUFHLENBQUM7SUFDM0MsQ0FBQztJQUVELElBQVcsVUFBVTtRQUNuQixNQUFNLENBQUMsSUFBSSxDQUFDLFlBQVksQ0FBQyxDQUFDLEdBQUcsSUFBSSxDQUFDLFNBQVMsQ0FBQyxDQUFDO0lBQy9DLENBQUM7SUFFRCxJQUFXLENBQUM7UUFDVixNQUFNLENBQUMsSUFBSSxDQUFDLFdBQVcsQ0FBQyxDQUFDLENBQUMsQ0FBQztJQUM3QixDQUFDO0lBRUQsSUFBVyxDQUFDO1FBQ1YsTUFBTSxDQUFDLElBQUksQ0FBQyxXQUFXLENBQUMsQ0FBQyxDQUFDLENBQUM7SUFDN0IsQ0FBQztJQUVELElBQVcsQ0FBQztRQUNWLE1BQU0sQ0FBQyxJQUFJLENBQUMsV0FBVyxDQUFDLENBQUMsQ0FBQyxDQUFDO0lBQzdCLENBQUM7SUFFRCxJQUFXLENBQUMsQ0FBQyxDQUFTO1FBQ3BCLElBQUksQ0FBQyxXQUFXLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUM7SUFDM0IsQ0FBQztJQUVELElBQVcsQ0FBQyxDQUFDLENBQVM7UUFDcEIsSUFBSSxDQUFDLFdBQVcsQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQztJQUMzQixDQUFDO0lBRUQsSUFBVyxDQUFDLENBQUMsQ0FBUztRQUNwQixJQUFJLENBQUMsV0FBVyxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDO0lBQzNCLENBQUM7SUFFTSxhQUFhO1FBQ2xCLE1BQU0sQ0FBQyxPQUFPLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxDQUFDO0lBQ2pDLENBQUM7SUFFTSxPQUFPLENBQUMsQ0FBVTtRQUN2QixNQUFNLENBQUMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxJQUFJLEVBQUUsQ0FBQyxDQUFDLENBQUM7SUFDOUIsQ0FBQztJQUVNLE9BQU8sQ0FBQyxDQUFVO1FBQ3ZCLE1BQU0sQ0FBQyxPQUFPLENBQUMsR0FBRyxDQUFDLElBQUksRUFBRSxDQUFDLENBQUMsQ0FBQztJQUM5QixDQUFDO0lBRU0sWUFBWSxDQUFDLENBQVU7UUFDNUIsTUFBTSxDQUFDLE9BQU8sQ0FBQyxRQUFRLENBQUMsSUFBSSxFQUFFLENBQUMsQ0FBQyxDQUFDO0lBQ25DLENBQUM7SUFFTSxZQUFZLENBQUMsQ0FBUztRQUMzQixNQUFNLENBQUMsT0FBTyxDQUFDLFFBQVEsQ0FBQyxDQUFDLEVBQUUsSUFBSSxDQUFDLENBQUM7SUFDbkMsQ0FBQztJQUVNLFVBQVU7UUFDZixNQUFNLENBQUMsT0FBTyxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsQ0FBQztJQUM5QixDQUFDO0lBRU0sU0FBUyxDQUFDLENBQVU7UUFDekIsTUFBTSxDQUFDLE9BQU8sQ0FBQyxNQUFNLENBQUMsSUFBSSxFQUFFLENBQUMsQ0FBQyxDQUFDO0lBQ2pDLENBQUM7SUFFTSxlQUFlLENBQUMsQ0FBVTtRQUMvQixNQUFNLENBQUMsT0FBTyxDQUFDLFlBQVksQ0FBQyxJQUFJLEVBQUUsQ0FBQyxDQUFDLENBQUM7SUFDdkMsQ0FBQztJQUVNLFNBQVMsQ0FBQyxDQUFVO1FBQ3pCLE1BQU0sQ0FBQyxPQUFPLENBQUMsS0FBSyxDQUFDLElBQUksRUFBRSxDQUFDLENBQUMsQ0FBQztJQUNoQyxDQUFDO0lBRU0sUUFBUTtRQUNiLE1BQU0sQ0FBQyxJQUFJLElBQUksQ0FBQyxDQUFDLEtBQUssSUFBSSxDQUFDLENBQUMsS0FBSyxJQUFJLENBQUMsQ0FBQyxHQUFHLENBQUM7SUFDN0MsQ0FBQztJQUVNLGVBQWU7UUFDcEIsTUFBTSxDQUFDLFVBQVUsSUFBSSxDQUFDLFFBQVEsRUFBRyxFQUFFLENBQUM7SUFDdEMsQ0FBQztJQUVELElBQVcsWUFBWSxLQUFhLE1BQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO0FBRWpELENBQUM7QUFFRCxlQUFlLE9BQU8sQ0FBQyIsImZpbGUiOiJNYXRoL1ZlY3RvcjMuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgVmVjdG9yQmFzZSBmcm9tIFwiLi9WZWN0b3JCYXNlXCI7XG5pbXBvcnQge0dMTSwgdmVjM30gZnJvbSBcImdsLW1hdHJpeFwiO1xuXG5jbGFzcyBWZWN0b3IzIGV4dGVuZHMgVmVjdG9yQmFzZSB7XG5cbiAgY29uc3RydWN0b3IoeDogbnVtYmVyLCB5OiBudW1iZXIsIHo6IG51bWJlcik7XG4gIGNvbnN0cnVjdG9yKHg6IEdMTS5JQXJyYXkpO1xuICBjb25zdHJ1Y3Rvcih4OiBudW1iZXIgfCBHTE0uSUFycmF5LCB5PzogbnVtYmVyLCB6PzogbnVtYmVyKSB7XG4gICAgc3VwZXIoKTtcbiAgICBpZiAodHlwZW9mIHkgPT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICAgIHRoaXMucmF3RWxlbWVudHMgPSA8R0xNLklBcnJheT54O1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB0aGlzLnJhd0VsZW1lbnRzID0gWzxudW1iZXI+eCwgeSwgel07XG4gIH1cblxuICBwdWJsaWMgc3RhdGljIGdldCBYVW5pdCgpOiBWZWN0b3IzIHtcbiAgICByZXR1cm4gbmV3IFZlY3RvcjMoMSwgMCwgMCk7XG4gIH1cblxuICBwdWJsaWMgc3RhdGljIGdldCBZVW5pdCgpOiBWZWN0b3IzIHtcbiAgICByZXR1cm4gbmV3IFZlY3RvcjMoMCwgMSwgMCk7XG4gIH1cblxuICBwdWJsaWMgc3RhdGljIGdldCBaVW5pdCgpOiBWZWN0b3IzIHtcbiAgICByZXR1cm4gbmV3IFZlY3RvcjMoMCwgMCwgMSk7XG4gIH1cblxuICBwdWJsaWMgc3RhdGljIGdldCBaZXJvKCk6IFZlY3RvcjMge1xuICAgIHJldHVybiBuZXcgVmVjdG9yMygwLCAwLCAwKTtcbiAgfVxuXG4gIHB1YmxpYyBzdGF0aWMgZ2V0IE9uZSgpOiBWZWN0b3IzIHtcbiAgICByZXR1cm4gbmV3IFZlY3RvcjMoMSwgMSwgMSk7XG4gIH1cblxuICBwdWJsaWMgc3RhdGljIGNvcHkoc291cmNlOiBWZWN0b3IzKTogVmVjdG9yMyB7XG4gICAgcmV0dXJuIG5ldyBWZWN0b3IzKHNvdXJjZS5YLCBzb3VyY2UuWSwgc291cmNlLlopO1xuICB9XG5cbiAgcHVibGljIHN0YXRpYyBkb3QodjE6IFZlY3RvcjMsIHYyOiBWZWN0b3IzKTogbnVtYmVyIHtcbiAgICByZXR1cm4gdmVjMy5kb3QodjEucmF3RWxlbWVudHMsIHYyLnJhd0VsZW1lbnRzKTtcbiAgfVxuXG4gIHB1YmxpYyBzdGF0aWMgYWRkKHYxOiBWZWN0b3IzLCB2MjogVmVjdG9yMyk6IFZlY3RvcjMge1xuICAgIGNvbnN0IG5ld1ZlYyA9IHZlYzMuY3JlYXRlKCk7XG4gICAgcmV0dXJuIG5ldyBWZWN0b3IzKHZlYzMuYWRkKG5ld1ZlYywgdjEucmF3RWxlbWVudHMsIHYyLnJhd0VsZW1lbnRzKSk7XG4gIH1cblxuICBwdWJsaWMgc3RhdGljIHN1YnRyYWN0KHYxOiBWZWN0b3IzLCB2MjogVmVjdG9yMyk6IFZlY3RvcjMge1xuICAgIGNvbnN0IG5ld1ZlYyA9IHZlYzMuY3JlYXRlKCk7XG4gICAgcmV0dXJuIG5ldyBWZWN0b3IzKHZlYzMuc3ViKG5ld1ZlYywgdjEucmF3RWxlbWVudHMsIHYyLnJhd0VsZW1lbnRzKSk7XG4gIH1cblxuICBwdWJsaWMgc3RhdGljIG11bHRpcGx5KHM6IG51bWJlciwgdjogVmVjdG9yMyk6IFZlY3RvcjMge1xuICAgIGNvbnN0IG5ld1ZlYyA9IHZlYzMuY3JlYXRlKCk7XG4gICAgcmV0dXJuIG5ldyBWZWN0b3IzKHZlYzMuc2NhbGUobmV3VmVjLCB2LnJhd0VsZW1lbnRzLCBzKSk7XG4gIH1cblxuICBwdWJsaWMgc3RhdGljIG5lZ2F0ZSh2MTogVmVjdG9yMyk6IFZlY3RvcjMge1xuICAgIHJldHVybiBWZWN0b3IzLm11bHRpcGx5KC0xLCB2MSk7XG4gIH1cblxuICBwdWJsaWMgc3RhdGljIGVxdWFscyh2MTogVmVjdG9yMywgdjI6IFZlY3RvcjMpOiBib29sZWFuIHtcbiAgICByZXR1cm4gVmVjdG9yQmFzZS5fX2VsZW1lbnRFcXVhbHModjEsIHYyKTtcbiAgfVxuXG4gIHB1YmxpYyBzdGF0aWMgbmVhcmx5RXF1YWxzKHYxOiBWZWN0b3IzLCB2MjogVmVjdG9yMyk6IGJvb2xlYW4ge1xuICAgIHJldHVybiBWZWN0b3JCYXNlLl9fbmVhcmx5RWxlbWVudEVxdWFscyh2MSwgdjIpO1xuICB9XG5cbiAgcHVibGljIHN0YXRpYyBub3JtYWxpemUodjE6IFZlY3RvcjMpOiBWZWN0b3IzIHtcbiAgICBjb25zdCBuZXdWZWMgPSB2ZWMzLmNyZWF0ZSgpO1xuICAgIHJldHVybiBuZXcgVmVjdG9yMyh2ZWMzLm5vcm1hbGl6ZShuZXdWZWMsIHYxLnJhd0VsZW1lbnRzKSk7XG4gIH1cblxuICBwdWJsaWMgc3RhdGljIGNyb3NzKHYxOiBWZWN0b3IzLCB2MjogVmVjdG9yMyk6IFZlY3RvcjMge1xuICAgIGNvbnN0IG5ld1ZlYyA9IHZlYzMuY3JlYXRlKCk7XG4gICAgcmV0dXJuIG5ldyBWZWN0b3IzKHZlYzMuY3Jvc3MobmV3VmVjLCB2MS5yYXdFbGVtZW50cywgdjIucmF3RWxlbWVudHMpKTtcbiAgfVxuXG5cbiAgcHVibGljIHN0YXRpYyBtaW4odjE6IFZlY3RvcjMsIHYyOiBWZWN0b3IzKTogVmVjdG9yMyB7XG4gICAgcmV0dXJuIG5ldyBWZWN0b3IzKFZlY3RvckJhc2UuX19mcm9tR2VuZXJhdGlvbkZ1bmN0aW9uKHYxLCB2MiwgKGksIF92MSwgX3YyKSA9PiBNYXRoLm1pbihfdjEucmF3RWxlbWVudHNbaV0sIF92Mi5yYXdFbGVtZW50c1tpXSkpKTtcbiAgfVxuICBwdWJsaWMgc3RhdGljIG1heCh2MTogVmVjdG9yMywgdjI6IFZlY3RvcjMpOiBWZWN0b3IzIHtcbiAgICByZXR1cm4gbmV3IFZlY3RvcjMoVmVjdG9yQmFzZS5fX2Zyb21HZW5lcmF0aW9uRnVuY3Rpb24odjEsIHYyLCAoaSwgX3YxLCBfdjIpID0+IE1hdGgubWF4KF92MS5yYXdFbGVtZW50c1tpXSwgX3YyLnJhd0VsZW1lbnRzW2ldKSkpO1xuICB9XG5cbiAgcHVibGljIHN0YXRpYyBhbmdsZSh2MTogVmVjdG9yMywgdjI6IFZlY3RvcjMpOiBudW1iZXIge1xuICAgIHJldHVybiBNYXRoLmFjb3MoVmVjdG9yMy5kb3QodjEubm9ybWFsaXplZCwgdjIubm9ybWFsaXplZCkpO1xuICB9XG5cbiAgcHVibGljIHN0YXRpYyBwYXJzZShzdHI6IHN0cmluZyk6IFZlY3RvcjMge1xuICAgIGNvbnN0IHBhcnNlUmVzdWx0ID0gVmVjdG9yQmFzZS5fX3BhcnNlKHN0cik7XG4gICAgY29uc3QgZWxlbWVudHMgPSBwYXJzZVJlc3VsdC5lbGVtZW50cztcblxuICAgIGlmICghZWxlbWVudHMgfHwgKGVsZW1lbnRzLmxlbmd0aCAhPT0gMSAmJiBlbGVtZW50cy5sZW5ndGggIT09IDMpKSB7XG4gICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH1cbiAgICBsZXQgcmVzdWx0O1xuICAgIGlmIChlbGVtZW50cy5sZW5ndGggPT09IDEpIHtcbiAgICAgIHJlc3VsdCA9IG5ldyBWZWN0b3IzKGVsZW1lbnRzWzBdLCBlbGVtZW50c1swXSwgZWxlbWVudHNbMF0pO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXN1bHQgPSBuZXcgVmVjdG9yMyhlbGVtZW50c1swXSwgZWxlbWVudHNbMV0sIGVsZW1lbnRzWzJdKTtcbiAgICB9XG4gICAgaWYgKHBhcnNlUmVzdWx0Lm5lZWROb3JtYWxpemUpIHtcbiAgICAgIHJlc3VsdCA9IHJlc3VsdC5ub3JtYWxpemVUaGlzKCk7XG4gICAgfVxuICAgIGlmIChwYXJzZVJlc3VsdC5jb2VmZmljaWVudCkge1xuICAgICAgcmVzdWx0ID0gcmVzdWx0Lm11bHRpcGx5V2l0aChwYXJzZVJlc3VsdC5jb2VmZmljaWVudCk7XG4gICAgfVxuICAgIGlmIChwYXJzZVJlc3VsdC5uZWVkTmVnYXRlKSB7XG4gICAgICByZXN1bHQgPSByZXN1bHQubmVnYXRlVGhpcygpO1xuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0O1xuICB9XG5cbiAgcHVibGljIHRvTWF0aGVtYXRpY2FTdHJpbmcoKTogc3RyaW5nIHtcbiAgICByZXR1cm4gYHske3RoaXMuWH0sJHt0aGlzLll9LCR7dGhpcy5afX1gO1xuICB9XG5cbiAgcHVibGljIGdldCBub3JtYWxpemVkKCkge1xuICAgIHJldHVybiB0aGlzLm11bHRpcGx5V2l0aCgxIC8gdGhpcy5tYWduaXR1ZGUpO1xuICB9XG5cbiAgcHVibGljIGdldCBYKCk6IG51bWJlciB7XG4gICAgcmV0dXJuIHRoaXMucmF3RWxlbWVudHNbMF07XG4gIH1cblxuICBwdWJsaWMgZ2V0IFkoKTogbnVtYmVyIHtcbiAgICByZXR1cm4gdGhpcy5yYXdFbGVtZW50c1sxXTtcbiAgfVxuXG4gIHB1YmxpYyBnZXQgWigpOiBudW1iZXIge1xuICAgIHJldHVybiB0aGlzLnJhd0VsZW1lbnRzWzJdO1xuICB9XG5cbiAgcHVibGljIHNldCBYKHg6IG51bWJlcikge1xuICAgIHRoaXMucmF3RWxlbWVudHNbMF0gPSAreDtcbiAgfVxuXG4gIHB1YmxpYyBzZXQgWSh5OiBudW1iZXIpIHtcbiAgICB0aGlzLnJhd0VsZW1lbnRzWzFdID0gK3k7XG4gIH1cblxuICBwdWJsaWMgc2V0IFooejogbnVtYmVyKSB7XG4gICAgdGhpcy5yYXdFbGVtZW50c1syXSA9ICt6O1xuICB9XG5cbiAgcHVibGljIG5vcm1hbGl6ZVRoaXMoKTogVmVjdG9yMyB7XG4gICAgcmV0dXJuIFZlY3RvcjMubm9ybWFsaXplKHRoaXMpO1xuICB9XG5cbiAgcHVibGljIGRvdFdpdGgodjogVmVjdG9yMyk6IG51bWJlciB7XG4gICAgcmV0dXJuIFZlY3RvcjMuZG90KHRoaXMsIHYpO1xuICB9XG5cbiAgcHVibGljIGFkZFdpdGgodjogVmVjdG9yMyk6IFZlY3RvcjMge1xuICAgIHJldHVybiBWZWN0b3IzLmFkZCh0aGlzLCB2KTtcbiAgfVxuXG4gIHB1YmxpYyBzdWJ0cmFjdFdpdGgodjogVmVjdG9yMyk6IFZlY3RvcjMge1xuICAgIHJldHVybiBWZWN0b3IzLnN1YnRyYWN0KHRoaXMsIHYpO1xuICB9XG5cbiAgcHVibGljIG11bHRpcGx5V2l0aChzOiBudW1iZXIpOiBWZWN0b3IzIHtcbiAgICByZXR1cm4gVmVjdG9yMy5tdWx0aXBseShzLCB0aGlzKTtcbiAgfVxuXG4gIHB1YmxpYyBuZWdhdGVUaGlzKCk6IFZlY3RvcjMge1xuICAgIHJldHVybiBWZWN0b3IzLm5lZ2F0ZSh0aGlzKTtcbiAgfVxuXG4gIHB1YmxpYyBlcXVhbFdpdGgodjogVmVjdG9yMyk6IGJvb2xlYW4ge1xuICAgIHJldHVybiBWZWN0b3IzLmVxdWFscyh0aGlzLCB2KTtcbiAgfVxuXG4gIHB1YmxpYyBuZWFybHlFcXVhbFdpdGgodjogVmVjdG9yMyk6IGJvb2xlYW4ge1xuICAgIHJldHVybiBWZWN0b3IzLm5lYXJseUVxdWFscyh0aGlzLCB2KTtcbiAgfVxuXG4gIHB1YmxpYyBjcm9zc1dpdGgodjogVmVjdG9yMyk6IFZlY3RvcjMge1xuICAgIHJldHVybiBWZWN0b3IzLmNyb3NzKHRoaXMsIHYpO1xuICB9XG5cbiAgcHVibGljIHRvU3RyaW5nKCk6IHN0cmluZyB7XG4gICAgcmV0dXJuIGAoJHt0aGlzLlh9LCAke3RoaXMuWX0sICR7dGhpcy5afSlgO1xuICB9XG5cbiAgcHVibGljIHRvRGlzcGxheVN0cmluZygpOiBzdHJpbmcge1xuICAgIHJldHVybiBgVmVjdG9yMyR7dGhpcy50b1N0cmluZygpIH1gO1xuICB9XG5cbiAgcHVibGljIGdldCBFbGVtZW50Q291bnQoKTogbnVtYmVyIHsgcmV0dXJuIDM7IH1cblxufVxuXG5leHBvcnQgZGVmYXVsdCBWZWN0b3IzO1xuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9

import VectorBase from "./VectorBase";
import { vec4 } from "gl-matrix";
class Vector4 extends VectorBase {
    constructor(x, y, z, w) {
        super();
        if (typeof y === "undefined") {
            this.rawElements = x;
            return;
        }
        this.rawElements = [x, y, z, w];
    }
    get normalized() {
        return this.multiplyWith(1 / this.magnitude);
    }
    get X() {
        return this.rawElements[0];
    }
    get Y() {
        return this.rawElements[1];
    }
    get Z() {
        return this.rawElements[2];
    }
    get W() {
        return this.rawElements[3];
    }
    set X(x) {
        this.rawElements[0] = +x;
    }
    set Y(y) {
        this.rawElements[1] = +y;
    }
    set Z(z) {
        this.rawElements[2] = +z;
    }
    set W(w) {
        this.rawElements[3] = +w;
    }
    static get XUnit() {
        return new Vector4(1, 0, 0, 0);
    }
    static get YUnit() {
        return new Vector4(0, 1, 0, 0);
    }
    static get ZUnit() {
        return new Vector4(0, 0, 1, 0);
    }
    static get WUnit() {
        return new Vector4(0, 0, 0, 1);
    }
    static get One() {
        return new Vector4(1, 1, 1, 1);
    }
    static get Zero() {
        return new Vector4(0, 0, 0, 0);
    }
    static copy(vec) {
        return new Vector4(vec.X, vec.Y, vec.Z, vec.W);
    }
    static dot(v1, v2) {
        return vec4.dot(v1.rawElements, v2.rawElements);
    }
    static add(v1, v2) {
        const newVec = vec4.create();
        return new Vector4(vec4.add(newVec, v1.rawElements, v2.rawElements));
    }
    static subtract(v1, v2) {
        const newVec = vec4.create();
        return new Vector4(vec4.sub(newVec, v1.rawElements, v2.rawElements));
    }
    static multiply(s, v) {
        const newVec = vec4.create();
        return new Vector4(vec4.scale(newVec, v.rawElements, s));
    }
    static negate(v1) {
        return Vector4.multiply(-1, v1);
    }
    static equals(v1, v2) {
        return VectorBase.__elementEquals(v1, v2);
    }
    static nearlyEquals(v1, v2) {
        return VectorBase.__nearlyElementEquals(v1, v2);
    }
    static normalize(v1) {
        const newVec = vec4.create();
        return new Vector4(vec4.normalize(newVec, v1.rawElements));
    }
    static min(v1, v2) {
        return new Vector4(VectorBase.__fromGenerationFunction(v1, v2, (i, _v1, _v2) => Math.min(_v1.rawElements[i], _v2.rawElements[i])));
    }
    static max(v1, v2) {
        return new Vector4(VectorBase.__fromGenerationFunction(v1, v2, (i, _v1, _v2) => Math.max(_v1.rawElements[i], _v2.rawElements[i])));
    }
    static angle(v1, v2) {
        return Math.acos(Vector4.dot(v1.normalized, v2.normalized));
    }
    static parse(str) {
        const parseResult = VectorBase.__parse(str);
        const elements = parseResult.elements;
        if (!elements || (elements.length !== 1 && elements.length !== 4)) {
            return undefined;
        }
        let result;
        if (elements.length === 1) {
            result = new Vector4(elements[0], elements[0], elements[0], elements[0]);
        }
        else {
            result = new Vector4(elements[0], elements[1], elements[2], elements[3]);
        }
        if (parseResult.needNormalize) {
            result = result.normalizeThis();
        }
        if (parseResult.coefficient) {
            result = result.multiplyWith(parseResult.coefficient);
        }
        if (parseResult.needNegate) {
            result = result.negateThis();
        }
        return result;
    }
    normalizeThis() {
        return Vector4.normalize(this);
    }
    dotWith(v) {
        return Vector4.dot(this, v);
    }
    addWith(v) {
        return Vector4.add(this, v);
    }
    subtractWith(v) {
        return Vector4.subtract(this, v);
    }
    multiplyWith(s) {
        return Vector4.multiply(s, this);
    }
    negateThis() {
        return Vector4.negate(this);
    }
    equalWith(v) {
        return Vector4.equals(this, v);
    }
    nearlyEqualWith(v) {
        return Vector4.nearlyEquals(this, v);
    }
    get ElementCount() { return 4; }
    toString() {
        return `(${this.X}, ${this.Y}, ${this.Z}, ${this.W})`;
    }
    toDisplayString() {
        return `Vector4${this.toString()}`;
    }
    toMathematicaString() {
        return `{${this.X},${this.Y},${this.Z},${this.W}}`;
    }
}
export default Vector4;

//# sourceMappingURL=data:application/json;base64,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QUFDLE9BQU8sQ0FBQyxNQUFNLENBQUMsSUFBSSxFQUFFLENBQUMsQ0FBQyxDQUFDO0lBQ2pDLENBQUM7SUFFTSxlQUFlLENBQUMsQ0FBVTtRQUMvQixNQUFNLENBQUMsT0FBTyxDQUFDLFlBQVksQ0FBQyxJQUFJLEVBQUUsQ0FBQyxDQUFDLENBQUM7SUFDdkMsQ0FBQztJQUVELElBQVcsWUFBWSxLQUFhLE1BQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO0lBRXhDLFFBQVE7UUFDYixNQUFNLENBQUMsSUFBSSxJQUFJLENBQUMsQ0FBQyxLQUFLLElBQUksQ0FBQyxDQUFDLEtBQUssSUFBSSxDQUFDLENBQUMsS0FBSyxJQUFJLENBQUMsQ0FBQyxHQUFHLENBQUM7SUFDeEQsQ0FBQztJQUVNLGVBQWU7UUFDcEIsTUFBTSxDQUFDLFVBQVUsSUFBSSxDQUFDLFFBQVEsRUFBRyxFQUFFLENBQUM7SUFDdEMsQ0FBQztJQUVNLG1CQUFtQjtRQUN4QixNQUFNLENBQUMsSUFBSSxJQUFJLENBQUMsQ0FBQyxJQUFJLElBQUksQ0FBQyxDQUFDLElBQUksSUFBSSxDQUFDLENBQUMsSUFBSSxJQUFJLENBQUMsQ0FBQyxHQUFHLENBQUM7SUFDckQsQ0FBQztBQUVILENBQUM7QUFHRCxlQUFlLE9BQU8sQ0FBQyIsImZpbGUiOiJNYXRoL1ZlY3RvcjQuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgVmVjdG9yQmFzZSBmcm9tIFwiLi9WZWN0b3JCYXNlXCI7XG5pbXBvcnQge0dMTSwgdmVjNH0gZnJvbSBcImdsLW1hdHJpeFwiO1xuXG5jbGFzcyBWZWN0b3I0IGV4dGVuZHMgVmVjdG9yQmFzZSB7XG4gIC8qXG4gICAqIFN0YXRpYyBwcm9wZXJ0aWVzXG4gICAqL1xuICBjb25zdHJ1Y3Rvcih4OiBHTE0uSUFycmF5KTtcbiAgY29uc3RydWN0b3IoeDogbnVtYmVyLCB5OiBudW1iZXIsIHo6IG51bWJlciwgdzogbnVtYmVyKTtcbiAgY29uc3RydWN0b3IoeDogbnVtYmVyIHwgR0xNLklBcnJheSwgeT86IG51bWJlciwgej86IG51bWJlciwgdz86IG51bWJlcikge1xuICAgIHN1cGVyKCk7XG4gICAgaWYgKHR5cGVvZiB5ID09PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICB0aGlzLnJhd0VsZW1lbnRzID0gPEdMTS5JQXJyYXk+eDtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdGhpcy5yYXdFbGVtZW50cyA9IFs8bnVtYmVyPngsIHksIHosIHddO1xuICB9XG5cbiAgcHVibGljIGdldCBub3JtYWxpemVkKCkge1xuICAgIHJldHVybiB0aGlzLm11bHRpcGx5V2l0aCgxIC8gdGhpcy5tYWduaXR1ZGUpO1xuICB9XG5cbiAgcHVibGljIGdldCBYKCkge1xuICAgIHJldHVybiB0aGlzLnJhd0VsZW1lbnRzWzBdO1xuICB9XG5cbiAgcHVibGljIGdldCBZKCkge1xuICAgIHJldHVybiB0aGlzLnJhd0VsZW1lbnRzWzFdO1xuICB9XG5cbiAgcHVibGljIGdldCBaKCkge1xuICAgIHJldHVybiB0aGlzLnJhd0VsZW1lbnRzWzJdO1xuICB9XG5cbiAgcHVibGljIGdldCBXKCkge1xuICAgIHJldHVybiB0aGlzLnJhd0VsZW1lbnRzWzNdO1xuICB9XG5cbiAgcHVibGljIHNldCBYKHg6IG51bWJlcikge1xuICAgIHRoaXMucmF3RWxlbWVudHNbMF0gPSAreDtcbiAgfVxuXG4gIHB1YmxpYyBzZXQgWSh5OiBudW1iZXIpIHtcbiAgICB0aGlzLnJhd0VsZW1lbnRzWzFdID0gK3k7XG4gIH1cblxuICBwdWJsaWMgc2V0IFooejogbnVtYmVyKSB7XG4gICAgdGhpcy5yYXdFbGVtZW50c1syXSA9ICt6O1xuICB9XG5cbiAgcHVibGljIHNldCBXKHc6IG51bWJlcikge1xuICAgIHRoaXMucmF3RWxlbWVudHNbM10gPSArdztcbiAgfVxuXG4gIHB1YmxpYyBzdGF0aWMgZ2V0IFhVbml0KCk6IFZlY3RvcjQge1xuICAgIHJldHVybiBuZXcgVmVjdG9yNCgxLCAwLCAwLCAwKTtcbiAgfVxuXG4gIHB1YmxpYyBzdGF0aWMgZ2V0IFlVbml0KCk6IFZlY3RvcjQge1xuICAgIHJldHVybiBuZXcgVmVjdG9yNCgwLCAxLCAwLCAwKTtcbiAgfVxuXG4gIHB1YmxpYyBzdGF0aWMgZ2V0IFpVbml0KCk6IFZlY3RvcjQge1xuICAgIHJldHVybiBuZXcgVmVjdG9yNCgwLCAwLCAxLCAwKTtcbiAgfVxuXG4gIHB1YmxpYyBzdGF0aWMgZ2V0IFdVbml0KCk6IFZlY3RvcjQge1xuICAgIHJldHVybiBuZXcgVmVjdG9yNCgwLCAwLCAwLCAxKTtcbiAgfVxuXG4gIHB1YmxpYyBzdGF0aWMgZ2V0IE9uZSgpOiBWZWN0b3I0IHtcbiAgICByZXR1cm4gbmV3IFZlY3RvcjQoMSwgMSwgMSwgMSk7XG4gIH1cblxuICBwdWJsaWMgc3RhdGljIGdldCBaZXJvKCk6IFZlY3RvcjQge1xuICAgIHJldHVybiBuZXcgVmVjdG9yNCgwLCAwLCAwLCAwKTtcbiAgfVxuXG4gIHB1YmxpYyBzdGF0aWMgY29weSh2ZWM6IFZlY3RvcjQpOiBWZWN0b3I0IHtcbiAgICByZXR1cm4gbmV3IFZlY3RvcjQodmVjLlgsIHZlYy5ZLCB2ZWMuWiwgdmVjLlcpO1xuICB9XG5cbiAgcHVibGljIHN0YXRpYyBkb3QodjE6IFZlY3RvcjQsIHYyOiBWZWN0b3I0KTogbnVtYmVyIHtcbiAgICByZXR1cm4gdmVjNC5kb3QodjEucmF3RWxlbWVudHMsIHYyLnJhd0VsZW1lbnRzKTtcbiAgfVxuXG4gIHB1YmxpYyBzdGF0aWMgYWRkKHYxOiBWZWN0b3I0LCB2MjogVmVjdG9yNCk6IFZlY3RvcjQge1xuICAgIGNvbnN0IG5ld1ZlYyA9IHZlYzQuY3JlYXRlKCk7XG4gICAgcmV0dXJuIG5ldyBWZWN0b3I0KHZlYzQuYWRkKG5ld1ZlYywgdjEucmF3RWxlbWVudHMsIHYyLnJhd0VsZW1lbnRzKSk7XG4gIH1cblxuICBwdWJsaWMgc3RhdGljIHN1YnRyYWN0KHYxOiBWZWN0b3I0LCB2MjogVmVjdG9yNCk6IFZlY3RvcjQge1xuICAgIGNvbnN0IG5ld1ZlYyA9IHZlYzQuY3JlYXRlKCk7XG4gICAgcmV0dXJuIG5ldyBWZWN0b3I0KHZlYzQuc3ViKG5ld1ZlYywgdjEucmF3RWxlbWVudHMsIHYyLnJhd0VsZW1lbnRzKSk7XG4gIH1cblxuICBwdWJsaWMgc3RhdGljIG11bHRpcGx5KHM6IG51bWJlciwgdjogVmVjdG9yNCk6IFZlY3RvcjQge1xuICAgIGNvbnN0IG5ld1ZlYyA9IHZlYzQuY3JlYXRlKCk7XG4gICAgcmV0dXJuIG5ldyBWZWN0b3I0KHZlYzQuc2NhbGUobmV3VmVjLCB2LnJhd0VsZW1lbnRzLCBzKSk7XG4gIH1cblxuICBwdWJsaWMgc3RhdGljIG5lZ2F0ZSh2MTogVmVjdG9yNCk6IFZlY3RvcjQge1xuICAgIHJldHVybiBWZWN0b3I0Lm11bHRpcGx5KC0xLCB2MSk7XG4gIH1cblxuICBwdWJsaWMgc3RhdGljIGVxdWFscyh2MTogVmVjdG9yNCwgdjI6IFZlY3RvcjQpOiBib29sZWFuIHtcbiAgICByZXR1cm4gVmVjdG9yQmFzZS5fX2VsZW1lbnRFcXVhbHModjEsIHYyKTtcbiAgfVxuXG4gIHB1YmxpYyBzdGF0aWMgbmVhcmx5RXF1YWxzKHYxOiBWZWN0b3I0LCB2MjogVmVjdG9yNCk6IGJvb2xlYW4ge1xuICAgIHJldHVybiBWZWN0b3JCYXNlLl9fbmVhcmx5RWxlbWVudEVxdWFscyh2MSwgdjIpO1xuICB9XG5cbiAgcHVibGljIHN0YXRpYyBub3JtYWxpemUodjE6IFZlY3RvcjQpOiBWZWN0b3I0IHtcbiAgICBjb25zdCBuZXdWZWMgPSB2ZWM0LmNyZWF0ZSgpO1xuICAgIHJldHVybiBuZXcgVmVjdG9yNCh2ZWM0Lm5vcm1hbGl6ZShuZXdWZWMsIHYxLnJhd0VsZW1lbnRzKSk7XG4gIH1cblxuXG4gIHB1YmxpYyBzdGF0aWMgbWluKHYxOiBWZWN0b3I0LCB2MjogVmVjdG9yNCk6IFZlY3RvcjQge1xuICAgIHJldHVybiBuZXcgVmVjdG9yNChWZWN0b3JCYXNlLl9fZnJvbUdlbmVyYXRpb25GdW5jdGlvbih2MSwgdjIsIChpLCBfdjEsIF92MikgPT4gTWF0aC5taW4oX3YxLnJhd0VsZW1lbnRzW2ldLCBfdjIucmF3RWxlbWVudHNbaV0pKSk7XG4gIH1cblxuICBwdWJsaWMgc3RhdGljIG1heCh2MTogVmVjdG9yNCwgdjI6IFZlY3RvcjQpOiBWZWN0b3I0IHtcbiAgICByZXR1cm4gbmV3IFZlY3RvcjQoVmVjdG9yQmFzZS5fX2Zyb21HZW5lcmF0aW9uRnVuY3Rpb24odjEsIHYyLCAoaSwgX3YxLCBfdjIpID0+IE1hdGgubWF4KF92MS5yYXdFbGVtZW50c1tpXSwgX3YyLnJhd0VsZW1lbnRzW2ldKSkpO1xuICB9XG5cbiAgcHVibGljIHN0YXRpYyBhbmdsZSh2MTogVmVjdG9yNCwgdjI6IFZlY3RvcjQpOiBudW1iZXIge1xuICAgIHJldHVybiBNYXRoLmFjb3MoVmVjdG9yNC5kb3QodjEubm9ybWFsaXplZCwgdjIubm9ybWFsaXplZCkpO1xuICB9XG5cbiAgcHVibGljIHN0YXRpYyBwYXJzZShzdHI6IHN0cmluZyk6IFZlY3RvcjQge1xuICAgIGNvbnN0IHBhcnNlUmVzdWx0ID0gVmVjdG9yQmFzZS5fX3BhcnNlKHN0cik7XG4gICAgY29uc3QgZWxlbWVudHMgPSBwYXJzZVJlc3VsdC5lbGVtZW50cztcbiAgICBpZiAoIWVsZW1lbnRzIHx8IChlbGVtZW50cy5sZW5ndGggIT09IDEgJiYgZWxlbWVudHMubGVuZ3RoICE9PSA0KSkge1xuICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICB9XG4gICAgbGV0IHJlc3VsdDtcbiAgICBpZiAoZWxlbWVudHMubGVuZ3RoID09PSAxKSB7XG4gICAgICByZXN1bHQgPSBuZXcgVmVjdG9yNChlbGVtZW50c1swXSwgZWxlbWVudHNbMF0sIGVsZW1lbnRzWzBdLCBlbGVtZW50c1swXSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJlc3VsdCA9IG5ldyBWZWN0b3I0KGVsZW1lbnRzWzBdLCBlbGVtZW50c1sxXSwgZWxlbWVudHNbMl0sIGVsZW1lbnRzWzNdKTtcbiAgICB9XG4gICAgaWYgKHBhcnNlUmVzdWx0Lm5lZWROb3JtYWxpemUpIHtcbiAgICAgIHJlc3VsdCA9IHJlc3VsdC5ub3JtYWxpemVUaGlzKCk7XG4gICAgfVxuICAgIGlmIChwYXJzZVJlc3VsdC5jb2VmZmljaWVudCkge1xuICAgICAgcmVzdWx0ID0gcmVzdWx0Lm11bHRpcGx5V2l0aChwYXJzZVJlc3VsdC5jb2VmZmljaWVudCk7XG4gICAgfVxuICAgIGlmIChwYXJzZVJlc3VsdC5uZWVkTmVnYXRlKSB7XG4gICAgICByZXN1bHQgPSByZXN1bHQubmVnYXRlVGhpcygpO1xuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0O1xuICB9XG5cbiAgcHVibGljIG5vcm1hbGl6ZVRoaXMoKTogVmVjdG9yNCB7XG4gICAgcmV0dXJuIFZlY3RvcjQubm9ybWFsaXplKHRoaXMpO1xuICB9XG5cbiAgcHVibGljIGRvdFdpdGgodjogVmVjdG9yNCk6IG51bWJlciB7XG4gICAgcmV0dXJuIFZlY3RvcjQuZG90KHRoaXMsIHYpO1xuICB9XG5cbiAgcHVibGljIGFkZFdpdGgodjogVmVjdG9yNCk6IFZlY3RvcjQge1xuICAgIHJldHVybiBWZWN0b3I0LmFkZCh0aGlzLCB2KTtcbiAgfVxuXG4gIHB1YmxpYyBzdWJ0cmFjdFdpdGgodjogVmVjdG9yNCk6IFZlY3RvcjQge1xuICAgIHJldHVybiBWZWN0b3I0LnN1YnRyYWN0KHRoaXMsIHYpO1xuICB9XG5cbiAgcHVibGljIG11bHRpcGx5V2l0aChzOiBudW1iZXIpOiBWZWN0b3I0IHtcbiAgICByZXR1cm4gVmVjdG9yNC5tdWx0aXBseShzLCB0aGlzKTtcbiAgfVxuXG4gIHB1YmxpYyBuZWdhdGVUaGlzKCk6IFZlY3RvcjQge1xuICAgIHJldHVybiBWZWN0b3I0Lm5lZ2F0ZSh0aGlzKTtcbiAgfVxuXG4gIHB1YmxpYyBlcXVhbFdpdGgodjogVmVjdG9yNCk6IGJvb2xlYW4ge1xuICAgIHJldHVybiBWZWN0b3I0LmVxdWFscyh0aGlzLCB2KTtcbiAgfVxuXG4gIHB1YmxpYyBuZWFybHlFcXVhbFdpdGgodjogVmVjdG9yNCk6IGJvb2xlYW4ge1xuICAgIHJldHVybiBWZWN0b3I0Lm5lYXJseUVxdWFscyh0aGlzLCB2KTtcbiAgfVxuXG4gIHB1YmxpYyBnZXQgRWxlbWVudENvdW50KCk6IG51bWJlciB7IHJldHVybiA0OyB9XG5cbiAgcHVibGljIHRvU3RyaW5nKCk6IHN0cmluZyB7XG4gICAgcmV0dXJuIGAoJHt0aGlzLlh9LCAke3RoaXMuWX0sICR7dGhpcy5afSwgJHt0aGlzLld9KWA7XG4gIH1cblxuICBwdWJsaWMgdG9EaXNwbGF5U3RyaW5nKCk6IHN0cmluZyB7XG4gICAgcmV0dXJuIGBWZWN0b3I0JHt0aGlzLnRvU3RyaW5nKCkgfWA7XG4gIH1cblxuICBwdWJsaWMgdG9NYXRoZW1hdGljYVN0cmluZygpOiBzdHJpbmcge1xuICAgIHJldHVybiBgeyR7dGhpcy5YfSwke3RoaXMuWX0sJHt0aGlzLlp9LCR7dGhpcy5XfX1gO1xuICB9XG5cbn1cblxuXG5leHBvcnQgZGVmYXVsdCBWZWN0b3I0O1xuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
